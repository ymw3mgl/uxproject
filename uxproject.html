<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">import React, { useState, useMemo, useEffect, useRef } from 'react';</p>
<p class="p1">import {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Calendar as CalendarIcon,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>BookOpen,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>MessageSquare,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>BarChart2,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Settings,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Bell,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Search,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>ChevronRight,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>ChevronLeft,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>ChevronDown,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>ChevronUp,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Plus,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>User,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Mail,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>FileText,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Upload,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Download,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Send,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Users,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Clock,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>MapPin,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>X,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Check,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>AlertCircle,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Paperclip,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Target,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>PieChart,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>EyeOff,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Calculator,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Award,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>TrendingUp,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>ShieldCheck,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>AlertTriangle,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>TrendingDown,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Repeat,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>CalendarDays,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>MoreHorizontal,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Reply,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Forward,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Trash2,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Inbox,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Send as SendIcon,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>File,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Megaphone,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>Info,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>CheckCircle,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>FileCheck,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>GraduationCap,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>BadgeCheck,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>CreditCard,</p>
<p class="p1"><span class="Apple-converted-space">  </span>LogOut</p>
<p class="p1">} from 'lucide-react';</p>
<p class="p2"><br></p>
<p class="p1">// --- 1. Constants &amp; Mock Data ---</p>
<p class="p2"><br></p>
<p class="p1">const CURRENT_USER = {</p>
<p class="p1"><span class="Apple-converted-space">  </span>name: '王大明',</p>
<p class="p1"><span class="Apple-converted-space">  </span>dept: '心理學系',</p>
<p class="p1"><span class="Apple-converted-space">  </span>degree: '學士班',</p>
<p class="p1"><span class="Apple-converted-space">  </span>year: '二年級',</p>
<p class="p1"><span class="Apple-converted-space">  </span>gender: '生理男性',</p>
<p class="p1"><span class="Apple-converted-space">  </span>studentId: '413315000',</p>
<p class="p1"><span class="Apple-converted-space">  </span>email: '413315000@alum.ccu.edu.tw',</p>
<p class="p1"><span class="Apple-converted-space">  </span>avatar: "https://api.dicebear.com/7.x/micah/svg?seed=Felix&amp;backgroundColor=e6e6e6&amp;clothing=hoodie&amp;eyebrows=up&amp;eyes=round&amp;mouth=smile"</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">const SEMESTERS = ['113-1', '113-2', '114-1', '114-2'];</p>
<p class="p2"><br></p>
<p class="p1">// Morandi Palette</p>
<p class="p1">const COLORS = {</p>
<p class="p1"><span class="Apple-converted-space">  </span>rose: { bg: 'bg-[#eadcdb]', text: 'text-[#8c5e5e]', border: 'border-[#d6b5b5]', cover: 'bg-[#cba6a6]', hex: '#cba6a6' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>blue: { bg: 'bg-[#dbe4ea]', text: 'text-[#5d707f]', border: 'border-[#b6c7d6]', cover: 'bg-[#9fb3c4]', hex: '#9fb3c4' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>green: { bg: 'bg-[#dce5dd]', text: 'text-[#5c7a63]', border: 'border-[#bcd1bf]', cover: 'bg-[#a3bfa7]', hex: '#a3bfa7' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>purple: { bg: 'bg-[#e4e0e8]', text: 'text-[#7d7286]', border: 'border-[#cdc5d4]', cover: 'bg-[#b8adc4]', hex: '#b8adc4' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>indigo: { bg: 'bg-[#dee1e8]', text: 'text-[#656d8a]', border: 'border-[#c4c9d9]', cover: 'bg-[#a3aac2]', hex: '#a3aac2' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>amber: { bg: 'bg-[#f0eadd]', text: 'text-[#8a7a5c]', border: 'border-[#e0d6c1]', cover: 'bg-[#d1c4a9]', hex: '#d1c4a9' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>teal: { bg: 'bg-[#dae8e6]', text: 'text-[#567a78]', border: 'border-[#b8d6d4]', cover: 'bg-[#98b3b9]', hex: '#98b3b9' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>gray: { bg: 'bg-[#f4f4f5]', text: 'text-[#52525b]', border: 'border-[#e4e4e7]', cover: 'bg-[#a1a1aa]', hex: '#a1a1aa' },</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">const COURSES_DATA = {</p>
<p class="p1"><span class="Apple-converted-space">  </span>'114-2': [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'psy_cog', code: 'PSY301', name: '人類學習與認知', type: '必修', professor: '李玉琇', ta: '無助教', location: '社科院 127', time: [{ day: 4, start: 10.25, end: 12 }], style: COLORS.rose },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'physio_psy_2', code: 'PSY305', name: '生理心理學（二）', type: '必修', professor: '李季湜', ta: '林助教', location: '社科院 423', time: [{ day: 3, start: 10.16, end: 12 }], style: COLORS.blue },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'personality', code: 'PSY308', name: '性格心理學', type: '必修', professor: '許功餘', ta: '張助教', location: '社科院 115', time: [{ day: 3, start: 13.25, end: 16 }], style: COLORS.green },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'abnormal', code: 'PSY310', name: '變態心理學', type: '必修', professor: '徐晏萱', ta: '黃助教', location: '社科院 127', time: [{ day: 1, start: 13.25, end: 16 }], style: COLORS.purple }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>'114-1': [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'exp_psy', code: 'PSY205', name: '心理學實驗法', type: '必修', professor: '陳欣進', ta: '陳助教', location: '社科院 423', time: [{ day: 2, start: 16.25, end: 19 }], style: COLORS.indigo },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'physio_psy_1', code: 'PSY304', name: '生理心理學（一）', type: '必修', professor: '蔡玲玲', ta: '林助教', location: '社科院 423', time: [{ day: 3, start: 10.16, end: 12 }], style: COLORS.amber },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'physio_2', code: 'BIO202', name: '生理學（二）', type: '選修', professor: '蔡玲玲', ta: '無助教', location: '社科院 423', time: [{ day: 1, start: 10.16, end: 12 }], style: COLORS.teal },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'social_psy', code: 'PSY210', name: '社會心理學', type: '必修', professor: '藤原健', ta: '王助教', location: '社科院 423', time: [{ day: 4, start: 13.25, end: 16 }], style: COLORS.rose }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>'113-2': [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'gen_psy_2', code: 'PSY102', name: '普通心理學（二）', type: '必修', professor: '梁思遠、藤原健、姜定宇', ta: '教學群', location: '社科院 127', time: [{ day: 3, start: 13.25, end: 16 }], style: COLORS.blue },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'stats_2', code: 'PSY202', name: '心理及教育統計學（二）', type: '必修', professor: '蘇雅蕙', ta: '陳助教', location: '社科院 127', time: [{ day: 2, start: 13.25, end: 16 }], style: COLORS.amber },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'physio_1', code: 'BIO201', name: '生理學（一）', type: '選修', professor: '蔡玲玲', ta: '無助教', location: '社科院 423', time: [{ day: 1, start: 15.16, end: 16 }], style: COLORS.green },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'reading_skills', code: 'PSY105', name: '心理學閱讀技巧', type: '選修', professor: '王豐彬', ta: '無助教', location: '社科院 127', time: [{ day: 3, start: 8.16, end: 10 }], style: { bg: 'bg-[#e5e5e5]', text: 'text-[#666666]', border: 'border-[#cccccc]', cover: 'bg-[#a3a3a3]', hex: '#a3a3a3' } }</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>'113-1': [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'gen_psy_1', code: 'PSY101', name: '普通心理學（一）', type: '必修', professor: '李季湜、陳欣進、趙長懋', ta: '教學群', location: '社科院 127', time: [{ day: 3, start: 13.25, end: 16 }], style: COLORS.blue },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'stats_1', code: 'PSY201', name: '心理及教育統計學（一）', type: '必修', professor: '蘇雅蕙', ta: '陳助教', location: '社科院 127', time: [{ day: 2, start: 13.25, end: 16 }], style: COLORS.amber },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'calc', code: 'MATH101', name: '微積分', type: '必修', professor: '陳孟豁', ta: '李助教', location: '共教215/管院105', time: [{ day: 2, start: 10.25, end: 11.5 }, { day: 4, start: 10.25, end: 11.5 }, { day: 3, start: 12, end: 13 }], style: COLORS.rose }</p>
<p class="p1"><span class="Apple-converted-space">  </span>]</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">const TASKS_MOCK = [</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 1, title: '變態心理學：期末個案分析報告', courseId: 'abnormal', type: 'assignment', deadline: '2025-05-15 23:59', status: 'pending', desc: '請選擇一個虛擬或真實案例，運用課堂所學之診斷標準進行分析。字數限制 3000 字。' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 2, title: '性格心理學：大五人格測驗反思', courseId: 'personality', type: 'assignment', deadline: '2025-05-20 23:59', status: 'pending', desc: '完成線上測驗後，撰寫 1000 字反思心得。' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 3, title: '生理心理學（二）：期中考 Ch1-5', courseId: 'physio_psy_2', type: 'exam', deadline: '2025-05-12 10:00', status: 'upcoming', desc: '範圍包含神經傳導與藥物機制。' },</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">const CONTACTS_MOCK = [</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 't1', name: '李玉琇', role: '教授', email: 'prof.li@ccu.edu.tw' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 't2', name: '蘇雅蕙', role: '教授', email: 'prof.su@ccu.edu.tw' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 's1', name: '陳欣進', role: '教授', email: 'prof.chen@ccu.edu.tw' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 'ta1', name: '林助教', role: '助教', email: 'ta.lin@ccu.edu.tw' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 'ta2', name: '黃助教', role: '助教', email: 'ta.huang@ccu.edu.tw' },</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">const MOCK_NOTIFICATIONS = [</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 1, title: '作業繳交提醒：變態心理學期末報告', time: '10 分鐘前', read: false, type: 'alert' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>{ id: 2, title: '新成績公佈：性格心理學期中考', time: '1 小時前', read: false, type: 'info' },</p>
<p class="p1">];</p>
<p class="p2"><br></p>
<p class="p1">// --- Mock Messages Data ---</p>
<p class="p1">const MOCK_MESSAGES_DATA = {</p>
<p class="p1"><span class="Apple-converted-space">  </span>chats: [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'c1',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'chat',</p>
<p class="p1"><span class="Apple-converted-space">      </span>name: '林助教 (生理心理學)',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>role: '助教',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>lastMsg: '關於期末考的範圍，請參考剛剛發布的公告。',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '10:42',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>unread: true,</p>
<p class="p1"><span class="Apple-converted-space">      </span>history: [</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ id: 1, sender: 'me', text: '助教你好，請問期末考會考第五章嗎？', time: '10:30' },</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ id: 2, sender: 'other', text: '同學你好，關於期末考的範圍，請參考剛剛發布的公告喔！基本上是以老師上課講過的為主。', time: '10:42' }</p>
<p class="p1"><span class="Apple-converted-space">      </span>]</p>
<p class="p1"><span class="Apple-converted-space">    </span>},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'c2',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'chat',</p>
<p class="p1"><span class="Apple-converted-space">      </span>name: '張小美',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>role: '同學',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>lastMsg: '等一下要不要一起去吃午餐？',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '09:15',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>unread: false,</p>
<p class="p1"><span class="Apple-converted-space">      </span>history: [</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ id: 1, sender: 'other', text: '誒等一下下課要不要一起去吃學餐？', time: '09:15' }</p>
<p class="p1"><span class="Apple-converted-space">      </span>]</p>
<p class="p1"><span class="Apple-converted-space">    </span>},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'c3',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'chat',</p>
<p class="p1"><span class="Apple-converted-space">      </span>name: '陳助教 (心教統)',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>role: '助教',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>lastMsg: '同學好，已上傳~',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '1 年前',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>unread: false,</p>
<p class="p1"><span class="Apple-converted-space">      </span>history: [</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ id: 1, sender: 'me', text: '助教您好～不好意思想請問一下，這次大概什麼時候會公佈平常助教課的正確解答呢？謝謝！', time: '1 年前' },</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ id: 2, sender: 'other', text: '同學好，已上傳~', time: '1 年前' }</p>
<p class="p1"><span class="Apple-converted-space">      </span>]</p>
<p class="p1"><span class="Apple-converted-space">    </span>},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'c4',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'chat',</p>
<p class="p1"><span class="Apple-converted-space">      </span>name: '陳助教 (心理及教育統計學（一）)',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>role: '助教',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>lastMsg: '同學好，已上傳~',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '一年前',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>unread: false,</p>
<p class="p1"><span class="Apple-converted-space">      </span>history: [</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ id: 1, sender: 'me', text: '助教您好～不好意思想請問一下，這次大概什麼時候會公佈平常助教課的正確解答呢？謝謝！', time: '一年前' },</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ id: 2, sender: 'other', text: '同學好，已上傳~', time: '一年前' }</p>
<p class="p1"><span class="Apple-converted-space">      </span>]</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>inbox: [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'e1',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'email',</p>
<p class="p1"><span class="Apple-converted-space">      </span>sender: '教務處',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>email: 'academic@ccu.edu.tw',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>subject: '114學年度第1學期選課通知',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '昨天',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>content: '親愛的同學您好：\n\n114學年度第1學期選課即將於下週一開始，請各位同學注意選課時間。\n\n詳細時程請見教務處網站。\n\n教務處 敬上',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>read: false,</p>
<p class="p1"><span class="Apple-converted-space">      </span>recipient: '王大明'</p>
<p class="p1"><span class="Apple-converted-space">    </span>},</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'e2',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'email',</p>
<p class="p1"><span class="Apple-converted-space">      </span>sender: '李玉琇 教授',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>email: 'prof.li@ccu.edu.tw',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>subject: '人類學習與認知 - 期末報告格式說明',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '2 天前',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>content: '各位修課同學：\n\n附檔為期末報告的格式範本，請務必遵照格式撰寫。若有任何問題，請於週五前提出。\n\n祝 學習順利\n李玉琇',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>read: true,</p>
<p class="p1"><span class="Apple-converted-space">      </span>recipient: '人類學習與認知 修課學生'</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>sent: [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 's1',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'email',</p>
<p class="p1"><span class="Apple-converted-space">      </span>sender: '我',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>recipient: '陳欣進 教授',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>subject: 'Re: 心理學實驗法請假',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '3 天前',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>content: '老師好，\n\n我是王大明，學號 413315000。因下週二身體不適需請病假一天，隨信附上診斷證明。\n\n謝謝老師。\n\n學生 王大明 敬上',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>read: true<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>],</p>
<p class="p1"><span class="Apple-converted-space">  </span>drafts: [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'd1',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'email',</p>
<p class="p1"><span class="Apple-converted-space">      </span>sender: '我',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>recipient: '助教',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>subject: '成績複查申請',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '1 週前',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>content: '助教您好，\n\n我對期中考第二題的評分有疑問，希望能申請複查...',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>read: true<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>]</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// --- 2. Shared Components ---</p>
<p class="p2"><br></p>
<p class="p1">const Card = ({ children, className = '', onClick }) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div onClick={onClick} className={`bg-[#ffffff] rounded-2xl shadow-[0_2px_10px_-5px_rgba(0,0,0,0.05)] border border-[#f0f0f0] ${className} ${onClick ? 'cursor-pointer hover:shadow-[0_8px_20px_-8px_rgba(0,0,0,0.08)] transition-all duration-200' : ''}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>{children}</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p1">);</p>
<p class="p2"><br></p>
<p class="p1">const Button = ({ children, onClick, className = '', variant = 'primary', icon: Icon, disabled = false }) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const variants = {</p>
<p class="p1"><span class="Apple-converted-space">    </span>primary: 'bg-[#8da399] text-white hover:bg-[#7a8f85] shadow-sm active:scale-95',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>secondary: 'bg-[#f4f1ea] text-[#6b6b6b] hover:bg-[#e8e4db] border border-[#e0dad0] active:scale-95',</p>
<p class="p1"><span class="Apple-converted-space">    </span>danger: 'bg-[#eadcdb] text-[#8c5e5e] hover:bg-[#d6b5b5] active:scale-95',</p>
<p class="p1"><span class="Apple-converted-space">    </span>outline: 'bg-transparent border border-[#d6ccc2] text-[#8c8c8c] hover:bg-[#faf9f6] hover:text-[#5c5c5c] active:scale-95'</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;button<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>onClick={onClick}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>disabled={disabled}</p>
<p class="p1"><span class="Apple-converted-space">      </span>className={`px-4 py-2 rounded-full font-medium text-sm transition-all duration-200 flex items-center justify-center gap-2 ${variants[variant]} ${className} ${disabled ? 'opacity-50 cursor-not-allowed' : ''}`}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>{Icon &amp;&amp; &lt;Icon size={16} /&gt;}</p>
<p class="p1"><span class="Apple-converted-space">      </span>{children}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">const Modal = ({ isOpen, onClose, title, children, maxWidth = 'max-w-lg' }) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>if (!isOpen) return null;</p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="fixed inset-0 bg-[#5c5c5c]/20 backdrop-blur-sm z-50 flex items-center justify-center p-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className={`bg-[#fdfcfb] rounded-3xl w-full ${maxWidth} shadow-[0_10px_40px_-10px_rgba(0,0,0,0.1)] animate-in fade-in zoom-in-95 duration-300 flex flex-col max-h-[90vh] border border-[#f0f0f0]`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex justify-between items-center p-5 border-b border-[#f2f0e9] flex-shrink-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;h3 className="font-serif font-bold text-lg text-[#4a4a4a]"&gt;{title}&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;button onClick={onClose} className="p-2 hover:bg-[#f2f0e9] rounded-full text-[#8c8c8c] transition-colors"&gt;&lt;X size={20} /&gt;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="p-5 overflow-y-auto flex-1 custom-scrollbar"&gt;{children}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// --- 3. View Components ---</p>
<p class="p2"><br></p>
<p class="p1">// --- TAB 1: CALENDAR (行事曆) ---</p>
<p class="p1">const CalendarView = ({ onComposeMessage }) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [viewMode, setViewMode] = useState('month');<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>const [selectedTask, setSelectedTask] = useState(null);</p>
<p class="p2"><span class="Apple-converted-space">  </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Reminder State</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [reminderSettings, setReminderSettings] = useState({ value: 15, unit: 'minutes' });</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showReminderModal, setShowReminderModal] = useState(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [customReminder, setCustomReminder] = useState({ value: '', unit: 'minutes' });</p>
<p class="p2"><span class="Apple-converted-space">  </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Personal Events State</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [personalEvents, setPersonalEvents] = useState([</p>
<p class="p1"><span class="Apple-converted-space">    </span>{<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>id: 'p1',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>title: '牙醫預約',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>date: '2025-05-14',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>time: '18:30',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>location: '信安牙醫',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>recurrence: 'none',<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>recurrenceEndDate: '',</p>
<p class="p1"><span class="Apple-converted-space">      </span>description: '記得帶健保卡，檢查臼齒。',</p>
<p class="p1"><span class="Apple-converted-space">      </span>type: 'personal'<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>]);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showEventModal, setShowEventModal] = useState(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [newEvent, setNewEvent] = useState({ title: '', date: '', time: '', location: '', recurrence: 'none', recurrenceEndDate: '', description: '' });</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Contact State within Task Modal</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [contactTarget, setContactTarget] = useState('professor'); // professor | ta</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [contactMethod, setContactMethod] = useState('email'); // email | message</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const daysInMonth = Array.from({ length: 31 }, (_, i) =&gt; i + 1);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const weekDays = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];</p>
<p class="p1"><span class="Apple-converted-space">  </span>const weekHours = Array.from({ length: 11 }, (_, i) =&gt; i + 8);<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Format reminder display</p>
<p class="p1"><span class="Apple-converted-space">  </span>const getReminderDisplay = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const unitMap = { minutes: '分鐘', hours: '小時', days: '天', weeks: '週' };</p>
<p class="p1"><span class="Apple-converted-space">    </span>return `${reminderSettings.value} ${unitMap[reminderSettings.unit]}前`;</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleSyncCalendar = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>alert("已成功連結至您的個人 Google 行事曆！");</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const getEventsForDay = (day) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const dateStr = `2025-05-${String(day).padStart(2, '0')}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const courseTasks = TASKS_MOCK.filter(t =&gt; new Date(t.deadline).getDate() === day);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const pEvents = personalEvents.filter(e =&gt; e.date === dateStr);</p>
<p class="p1"><span class="Apple-converted-space">    </span>return [...courseTasks, ...pEvents];</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleAddEvent = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if(!newEvent.title || !newEvent.date) return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>setPersonalEvents([...personalEvents, { ...newEvent, id: `p${Date.now()}`, type: 'personal' }]);</p>
<p class="p1"><span class="Apple-converted-space">    </span>setShowEventModal(false);</p>
<p class="p1"><span class="Apple-converted-space">    </span>setNewEvent({ title: '', date: '', time: '', location: '', recurrence: 'none', recurrenceEndDate: '', description: '' });</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleSaveReminder = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (customReminder.value) {</p>
<p class="p1"><span class="Apple-converted-space">        </span>setReminderSettings({ value: parseInt(customReminder.value), unit: customReminder.unit });</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>setShowReminderModal(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleContactSubmit = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const course = COURSES_DATA['114-2'].find(c =&gt; c.id === selectedTask.courseId);</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!course) return;</p>
<p class="p2"><span class="Apple-converted-space">    </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>const recipientName = contactTarget === 'professor' ? course.professor : course.ta;</p>
<p class="p1"><span class="Apple-converted-space">    </span>onComposeMessage({</p>
<p class="p1"><span class="Apple-converted-space">      </span>to: recipientName,</p>
<p class="p1"><span class="Apple-converted-space">      </span>context: `關於 ${selectedTask.title} 的問題`,</p>
<p class="p1"><span class="Apple-converted-space">      </span>type: contactMethod</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>setSelectedTask(null);</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="h-full flex flex-col space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Header */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex justify-between items-center bg-[#ffffff] p-4 rounded-2xl border border-[#f0f0f0] shadow-sm flex-shrink-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex items-center gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;h2 className="font-serif text-lg font-bold text-[#4a4a4a] tracking-wide"&gt;2025 年 5 月&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="flex bg-[#f7f5f0] rounded-full p-1 border border-[#e0dad0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button onClick={() =&gt; setViewMode('month')} className={`px-4 py-1 text-xs rounded-full transition-all font-medium ${viewMode === 'month' ? 'bg-[#ffffff] shadow-sm text-[#5c5c5c]' : 'text-[#9e9e9e] hover:text-[#7a7a7a]'}`}&gt;月&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button onClick={() =&gt; setViewMode('week')} className={`px-4 py-1 text-xs rounded-full transition-all font-medium ${viewMode === 'week' ? 'bg-[#ffffff] shadow-sm text-[#5c5c5c]' : 'text-[#9e9e9e] hover:text-[#7a7a7a]'}`}&gt;週&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex items-center gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;Button variant="secondary" icon={Plus} className="px-3 py-1.5 text-xs" onClick={() =&gt; setShowEventModal(true)}&gt;新增事件&lt;/Button&gt;</p>
<p class="p2"><span class="Apple-converted-space">           </span></p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="flex items-center gap-2 text-xs text-[#8c8c8c] bg-[#f7f5f0] px-3 py-1.5 rounded-full border border-[#e0dad0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;Bell size={12}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;span&gt;提醒: {getReminderDisplay()}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;button className="text-[#8da399] hover:underline ml-1 font-bold" onClick={() =&gt; setShowReminderModal(true)}&gt;修改&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;Button variant="outline" onClick={handleSyncCalendar} icon={CalendarIcon} className="px-3 py-1.5 text-xs"&gt;同步&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Calendar Grid */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex-1 overflow-hidden bg-[#ffffff] rounded-2xl border border-[#f0f0f0] shadow-sm p-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>{viewMode === 'month' ? (</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="h-full grid grid-cols-7 grid-rows-6 gap-px bg-[#f7f5f0] rounded-xl overflow-hidden border border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>{weekDays.map(d =&gt; &lt;div key={d} className="bg-[#ffffff] p-2 text-center text-xs font-bold text-[#a09a94] uppercase tracking-widest"&gt;{d}&lt;/div&gt;)}</p>
<p class="p1"><span class="Apple-converted-space">            </span>{[...Array(4)].map((_, i) =&gt; &lt;div key={`pad-${i}`} className="bg-[#ffffff/50]"&gt;&lt;/div&gt;)}</p>
<p class="p1"><span class="Apple-converted-space">            </span>{daysInMonth.map(day =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const events = getEventsForDay(day);</p>
<p class="p1"><span class="Apple-converted-space">                </span>return (</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div key={day} className="bg-[#ffffff] p-1.5 hover:bg-[#faf9f6] transition-colors relative group cursor-pointer flex flex-col items-start min-h-0 overflow-hidden" onClick={() =&gt; { if(events.length === 0) { setNewEvent({...newEvent, date: `2025-05-${String(day).padStart(2,'0')}`}); setShowEventModal(true); } }}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span className={`text-xs font-medium w-5 h-5 flex items-center justify-center rounded-full mb-1 flex-shrink-0 ${day === 12 ? 'bg-[#8da399] text-white shadow-sm' : 'text-[#6b6b6b]'}`}&gt;{day}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="w-full space-y-0.5 overflow-y-auto custom-scrollbar flex-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>{events.map(event =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                          </span>key={event.id}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                          </span>onClick={(e) =&gt; { e.stopPropagation(); setSelectedTask(event); }}</p>
<p class="p1"><span class="Apple-converted-space">                          </span>className={`text-[9px] px-1 py-0.5 rounded truncate border font-medium cursor-pointer hover:opacity-80 transition-opacity</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${event.type === 'personal' ? 'bg-[#f4f4f5] text-[#52525b] border-[#e4e4e7]' :<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                              </span>event.type === 'exam' ? 'bg-[#eadcdb] text-[#8c5e5e] border-[#d6b5b5]' : 'bg-[#f4f1ea] text-[#8a7a5c] border-[#e0d6c1]'}</p>
<p class="p1"><span class="Apple-converted-space">                          </span>`}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>{event.type === 'personal' ? '' : event.type === 'exam' ? '考: ' : '作: '} {event.title}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>);</p>
<p class="p1"><span class="Apple-converted-space">            </span>})}</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">          </span>/* Week View Simplified */</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="h-full flex flex-col relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div className="grid grid-cols-[50px_repeat(5,1fr)] flex-1 h-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="flex flex-col h-full border-r border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;div className="h-8 bg-white z-20 border-b border-[#f0f0f0]"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>{weekHours.map(h =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div key={h} className="flex-1 border-b border-[#f7f7f7] flex items-start justify-center pt-1 text-[10px] font-medium text-[#b0b0b0]"&gt;{h}:00&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{['Mon', 'Tue', 'Wed', 'Thu', 'Fri'].map((d, dIdx) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div key={d} className="flex flex-col h-full border-r border-[#f0f0f0] relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="h-8 flex items-center justify-center font-serif font-bold text-[#a09a94] bg-white z-20 border-b border-[#f0f0f0] tracking-wider text-xs"&gt;{d}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="flex-1 relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{weekHours.map(h =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;div key={`${h}-${d}`} className="absolute w-full border-b border-[#fcfcfc]" style={{ top: `${((h - 8) / 11) * 100}%`, height: `${(1/11)*100}%` }}&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{dIdx === 0 &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;div className="absolute left-1 right-1 p-1.5 bg-[#eadcdb] rounded border border-[#d6b5b5] text-[10px] text-[#8c5e5e] shadow-sm cursor-pointer hover:brightness-95 transition-all z-10"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                                </span>style={{ top: `${((10 - 8) / 11) * 100}%`, height: 'auto' }}</p>
<p class="p1"><span class="Apple-converted-space">                                </span>onClick={() =&gt; setSelectedTask(TASKS_MOCK[0])}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;div className="font-bold mb-0.5"&gt;作業截止&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;div className="truncate opacity-80"&gt;變態心理學&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>)}</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>))}</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>)}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Task / Event Detail Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={!!selectedTask} onClose={() =&gt; setSelectedTask(null)} title={selectedTask?.type === 'personal' ? "私人行程" : "任務詳情"} maxWidth="max-w-xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>{selectedTask &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="space-y-5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>{selectedTask.type === 'personal' ? (</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Personal Event Detail</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="flex items-start gap-4 p-4 bg-[#faf9f6] rounded-xl border border-[#e0dad0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="p-3 rounded-xl bg-[#f4f4f5] text-[#52525b]"&gt;&lt;User size={24}/&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;h4 className="text-lg font-serif font-bold text-[#4a4a4a] mb-1"&gt;{selectedTask.title}&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="text-sm text-[#8c8c8c] space-y-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;p className="flex items-center"&gt;&lt;Clock size={14} className="mr-1.5"/&gt; {selectedTask.date} {selectedTask.time}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;p className="flex items-center"&gt;&lt;MapPin size={14} className="mr-1.5"/&gt; {selectedTask.location || '無地點'}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>{selectedTask.recurrence !== 'none' &amp;&amp; &lt;p className="flex items-center text-[#8da399]"&gt;&lt;Repeat size={14} className="mr-1.5"/&gt; 重複: {selectedTask.recurrence === 'daily' ? '每天' : selectedTask.recurrence === 'weekly' ? '每週' : selectedTask.recurrence === 'monthly' ? '每月' : '每年'}&lt;/p&gt;}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                  </span></p>
<p class="p1"><span class="Apple-converted-space">                  </span>{selectedTask.description &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="bg-white p-3 rounded-xl border border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] uppercase tracking-widest mb-1 block"&gt;備註&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;p className="text-sm text-[#5c5c5c] leading-relaxed"&gt;{selectedTask.description}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>)}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="flex justify-end gap-3 pt-4 border-t border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;Button variant="secondary" onClick={() =&gt; setSelectedTask(null)}&gt;關閉&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;Button variant="danger" icon={Trash2} onClick={() =&gt; { setPersonalEvents(personalEvents.filter(e =&gt; e.id !== selectedTask.id)); setSelectedTask(null); }}&gt;刪除&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Course Task Detail</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="flex items-start gap-4 p-4 bg-[#faf9f6] rounded-xl border border-[#e0dad0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className={`p-3 rounded-xl ${selectedTask.type === 'exam' ? 'bg-[#eadcdb] text-[#8c5e5e]' : 'bg-[#e0d6c1] text-[#8a7a5c]'}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>{selectedTask.type === 'exam' ? &lt;AlertCircle size={24}/&gt; : &lt;FileText size={24}/&gt;}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;h4 className="text-lg font-serif font-bold text-[#4a4a4a] mb-1"&gt;{selectedTask.title}&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;p className="text-sm text-[#8c8c8c] flex items-center font-medium"&gt;&lt;Clock size={14} className="mr-1.5"/&gt; 截止期限: {selectedTask.deadline}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                  </span></p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] uppercase tracking-widest mb-2 block"&gt;任務說明&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;p className="text-[#5c5c5c] leading-relaxed text-sm font-light"&gt;{selectedTask.desc}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="bg-[#fdfcfb] border border-[#e0dad0] rounded-xl p-4 mt-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;h4 className="text-xs font-bold text-[#8da399] uppercase tracking-widest mb-3 flex items-center gap-1"&gt;&lt;MessageSquare size={12}/&gt; 有問題嗎？聯絡教學團隊&lt;/h4&gt;</p>
<p class="p2"><span class="Apple-converted-space">                      </span></p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="flex flex-col gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div className="flex gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="flex-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] mb-1 block"&gt;聯絡對象&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div className="flex gap-1 bg-[#f7f5f0] p-1 rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                   </span>&lt;button onClick={() =&gt; setContactTarget('professor')} className={`flex-1 py-1.5 text-xs rounded-md transition-all ${contactTarget === 'professor' ? 'bg-white shadow-sm text-[#5c5c5c] font-bold' : 'text-[#9e9e9e]'}`}&gt;教授&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                   </span>&lt;button onClick={() =&gt; setContactTarget('ta')} className={`flex-1 py-1.5 text-xs rounded-md transition-all ${contactTarget === 'ta' ? 'bg-white shadow-sm text-[#5c5c5c] font-bold' : 'text-[#9e9e9e]'}`}&gt;助教&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="flex-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] mb-1 block"&gt;聯絡方式&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div className="flex gap-1 bg-[#f7f5f0] p-1 rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                   </span>&lt;button onClick={() =&gt; setContactMethod('email')} className={`flex-1 py-1.5 text-xs rounded-md transition-all ${contactMethod === 'email' ? 'bg-white shadow-sm text-[#5c5c5c] font-bold' : 'text-[#9e9e9e]'}`}&gt;寄信&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                   </span>&lt;button onClick={() =&gt; setContactMethod('message')} className={`flex-1 py-1.5 text-xs rounded-md transition-all ${contactMethod === 'message' ? 'bg-white shadow-sm text-[#5c5c5c] font-bold' : 'text-[#9e9e9e]'}`}&gt;訊息&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;Button variant="primary" className="w-full" onClick={handleContactSubmit}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;Send size={14} className="mr-1"/&gt; 發送{contactMethod === 'email' ? '郵件' : '訊息'}</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                  </span>{selectedTask.type === 'assignment' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="pt-4 border-t border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;Button variant="secondary" icon={Upload} className="w-full"&gt;上傳作業檔案&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>)}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>)}</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>)}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Reminder Settings Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={showReminderModal} onClose={() =&gt; setShowReminderModal(false)} title="設定預設提醒時間"&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p className="text-sm text-[#8c8c8c]"&gt;請選擇所有作業與考試的預設提醒時間：&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="grid grid-cols-2 gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>{[</p>
<p class="p1"><span class="Apple-converted-space">                 </span>{ val: 15, u: 'minutes', label: '15 分鐘前' },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>{ val: 30, u: 'minutes', label: '30 分鐘前' },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>{ val: 60, u: 'minutes', label: '1 小時前' },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                 </span>{ val: 1440, u: 'minutes', label: '1 天前' }</p>
<p class="p1"><span class="Apple-converted-space">               </span>].map(opt =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;button<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>key={opt.label}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>onClick={() =&gt; { setReminderSettings({ value: opt.val, unit: opt.u }); setShowReminderModal(false); }}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>className={`p-3 rounded-xl border text-sm font-medium transition-all ${reminderSettings.value === opt.val ? 'border-[#8da399] bg-[#8da399]/10 text-[#8da399]' : 'border-[#e0dad0] hover:bg-[#f7f5f0] text-[#5c5c5c]'}`}</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>{opt.label}</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>))}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="pt-4 border-t border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-2 block"&gt;自訂時間&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div className="flex gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;input<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                   </span>type="number"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                   </span>className="flex-1 p-2 border border-[#e0dad0] rounded-lg"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                   </span>placeholder="數值"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                   </span>value={customReminder.value}</p>
<p class="p1"><span class="Apple-converted-space">                   </span>onChange={e =&gt; setCustomReminder({...customReminder, value: e.target.value})}</p>
<p class="p1"><span class="Apple-converted-space">                 </span>/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;select<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                   </span>className="p-2 border border-[#e0dad0] rounded-lg bg-white text-[#5c5c5c]"</p>
<p class="p1"><span class="Apple-converted-space">                   </span>value={customReminder.unit}</p>
<p class="p1"><span class="Apple-converted-space">                   </span>onChange={e =&gt; setCustomReminder({...customReminder, unit: e.target.value})}</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="minutes"&gt;分鐘&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="hours"&gt;小時&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="days"&gt;天&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="weeks"&gt;週&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;Button onClick={handleSaveReminder} className="px-4"&gt;儲存&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Add Personal Event Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={showEventModal} onClose={() =&gt; setShowEventModal(false)} title="新增個人行程"&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-1 block"&gt;事件名稱&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;input type="text" className="w-full p-2 border border-[#e0dad0] rounded-lg bg-[#fdfcfb] focus:outline-none focus:border-[#8da399]" value={newEvent.title} onChange={e =&gt; setNewEvent({...newEvent, title: e.target.value})} placeholder="例如：社團成發、牙醫..." /&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="grid grid-cols-2 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-1 block"&gt;日期&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;input type="date" className="w-full p-2 border border-[#e0dad0] rounded-lg bg-[#fdfcfb]" value={newEvent.date} onChange={e =&gt; setNewEvent({...newEvent, date: e.target.value})} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-1 block"&gt;時間&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;input type="time" className="w-full p-2 border border-[#e0dad0] rounded-lg bg-[#fdfcfb]" value={newEvent.time} onChange={e =&gt; setNewEvent({...newEvent, time: e.target.value})} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-1 block"&gt;地點&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;input type="text" className="w-full p-2 border border-[#e0dad0] rounded-lg bg-[#fdfcfb]" value={newEvent.location} onChange={e =&gt; setNewEvent({...newEvent, location: e.target.value})} placeholder="選填" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-1 block"&gt;備註&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;textarea className="w-full p-2 border border-[#e0dad0] rounded-lg bg-[#fdfcfb] resize-none h-20" value={newEvent.description} onChange={e =&gt; setNewEvent({...newEvent, description: e.target.value})} placeholder="選填" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="pt-2 grid grid-cols-2 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-1 block"&gt;重複頻率&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;select<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                      </span>className="w-full p-2 border border-[#e0dad0] rounded-lg bg-[#fdfcfb] text-[#5c5c5c]"</p>
<p class="p1"><span class="Apple-converted-space">                      </span>value={newEvent.recurrence}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                      </span>onChange={e =&gt; setNewEvent({...newEvent, recurrence: e.target.value})}</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;option value="none"&gt;不重複&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;option value="daily"&gt;每天&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;option value="weekly"&gt;每週&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;option value="monthly"&gt;每月&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;option value="yearly"&gt;每年&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>{newEvent.recurrence !== 'none' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div className="animate-in fade-in slide-in-from-left-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;label className="text-xs font-bold text-[#b0b0b0] mb-1 block"&gt;結束重複日期&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;input type="date" className="w-full p-2 border border-[#e0dad0] rounded-lg bg-[#fdfcfb]" value={newEvent.recurrenceEndDate} onChange={e =&gt; setNewEvent({...newEvent, recurrenceEndDate: e.target.value})} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>)}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="pt-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;Button className="w-full" onClick={handleAddEvent} icon={Plus}&gt;新增至行事曆&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// --- TAB 2: SCHEDULE (課表) ---</p>
<p class="p1">const ScheduleView = ({ onNavigateToCourse }) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [currentSemester, setCurrentSemester] = useState('114-2');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri'];</p>
<p class="p1"><span class="Apple-converted-space">  </span>const hoursCount = 13;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>const hours = Array.from({ length: hoursCount }, (_, i) =&gt; i + 8);<span class="Apple-converted-space"> </span></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="h-full flex flex-col space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;h2 className="font-serif text-lg font-bold text-[#4a4a4a] tracking-wide"&gt;我的課表&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;div className="flex bg-[#fdfcfb] rounded-full border border-[#f0f0f0] p-1 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>{SEMESTERS.map(sem =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;button</p>
<p class="p1"><span class="Apple-converted-space">                </span>key={sem}</p>
<p class="p1"><span class="Apple-converted-space">                </span>onClick={() =&gt; setCurrentSemester(sem)}</p>
<p class="p1"><span class="Apple-converted-space">                </span>className={`px-4 py-1.5 rounded-full text-sm font-medium transition-all ${currentSemester === sem ? 'bg-[#8da399] text-white shadow-sm' : 'text-[#8c8c8c] hover:bg-[#f2f0e9]'}`}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{sem}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>))}</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex-1 bg-[#ffffff] border border-[#f0f0f0] rounded-2xl shadow-sm overflow-hidden p-2 relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="h-full flex flex-col w-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>{/* Header Row */}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="flex h-10 border-b border-[#f0f0f0] flex-shrink-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div className="w-[50px] bg-[#ffffff] sticky left-0 z-30"&gt;&lt;/div&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">               </span>{days.map(d =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div key={d} className="flex-1 flex items-center justify-center font-serif font-bold text-[#a09a94] border-l border-[#f0f0f0] tracking-wider bg-[#ffffff] text-sm"&gt;{d}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>))}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>{/* Grid Body */}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="flex-1 flex relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* Time Column */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="w-[50px] flex flex-col border-r border-[#f0f0f0] bg-[#ffffff] flex-shrink-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>{hours.map(h =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div key={h} className="flex-1 flex items-start justify-center pt-1 text-[10px] font-medium text-[#b0b0b0] font-serif border-b border-[#f7f7f7]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>{h}:00</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* Days Columns Background */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="flex-1 flex relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>{[0,1,2,3,4].map(i =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div key={i} className="flex-1 border-r border-[#fcfcfc] relative h-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{hours.map(h =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;div key={h} className="absolute w-full border-b border-[#fcfcfc]" style={{</p>
<p class="p1"><span class="Apple-converted-space">                            </span>top: `${((h - 8) / hoursCount) * 100}%`,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>height: `${(1/hoursCount)*100}%`</p>
<p class="p1"><span class="Apple-converted-space">                          </span>}}&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>))}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                   </span>{/* Course Blocks Overlay */}</p>
<p class="p1"><span class="Apple-converted-space">                   </span>{COURSES_DATA[currentSemester]?.map(course =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                     </span>course.time.map((t, idx) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;div</p>
<p class="p1"><span class="Apple-converted-space">                          </span>key={`${course.id}-${idx}`}</p>
<p class="p1"><span class="Apple-converted-space">                          </span>onClick={() =&gt; onNavigateToCourse(course)}</p>
<p class="p1"><span class="Apple-converted-space">                          </span>className={`</p>
<p class="p1"><span class="Apple-converted-space">                            </span>absolute mx-1 rounded-lg border cursor-pointer<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>hover:brightness-95 hover:shadow-md transition-all duration-300</p>
<p class="p1"><span class="Apple-converted-space">                            </span>flex flex-col justify-center px-2 pointer-events-auto overflow-hidden</p>
<p class="p1"><span class="Apple-converted-space">                            </span>${course.style.bg} ${course.style.border} border-l-[3px]</p>
<p class="p1"><span class="Apple-converted-space">                          </span>`}</p>
<p class="p1"><span class="Apple-converted-space">                          </span>style={{</p>
<p class="p1"><span class="Apple-converted-space">                            </span>left: `${(t.day - 1) * 20}%`,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                            </span>width: '20%',</p>
<p class="p1"><span class="Apple-converted-space">                            </span>top: `${((t.start - 8) / hoursCount) * 100}%`,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>height: `${((t.end - t.start) / hoursCount) * 100}%`,</p>
<p class="p1"><span class="Apple-converted-space">                            </span>zIndex: 10</p>
<p class="p1"><span class="Apple-converted-space">                          </span>}}</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div className={`font-bold text-[10px] leading-tight mb-0.5 ${course.style.text} truncate`}&gt;{course.name}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div className={`hidden md:flex items-center text-[9px] opacity-80 ${course.style.text} truncate`}&gt;&lt;MapPin size={8} className="mr-1"/&gt;{course.location}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>))</p>
<p class="p1"><span class="Apple-converted-space">                   </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// --- TAB 3: COURSE DASHBOARD (課程儀表板) ---</p>
<p class="p1">const CourseDashboard = ({ selectedCourse: initialCourse, onBack, onComposeMessage }) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [activeTab, setActiveTab] = useState('announcement');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [currentSemester, setCurrentSemester] = useState('114-2');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [selectedCourseId, setSelectedCourseId] = useState(null);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [viewMode, setViewMode] = useState('grid');</p>
<p class="p2"><span class="Apple-converted-space">  </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>// New States for Interactions</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showUploadModal, setShowUploadModal] = useState(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showFeedbackModal, setShowFeedbackModal] = useState(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [contactTarget, setContactTarget] = useState(null); // { name, role }</p>
<p class="p2"><span class="Apple-converted-space">  </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>useEffect(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (initialCourse) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>let foundSem = '114-2';</p>
<p class="p1"><span class="Apple-converted-space">      </span>Object.keys(COURSES_DATA).forEach(sem =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>if (COURSES_DATA[sem].find(c =&gt; c.id === initialCourse.id)) foundSem = sem;</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">      </span>setCurrentSemester(foundSem);</p>
<p class="p1"><span class="Apple-converted-space">      </span>setSelectedCourseId(initialCourse.id);</p>
<p class="p1"><span class="Apple-converted-space">      </span>setViewMode('detail');</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">      </span>setViewMode('grid');</p>
<p class="p1"><span class="Apple-converted-space">      </span>setSelectedCourseId(null);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>}, [initialCourse]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const currentCourse = useMemo(() =&gt; COURSES_DATA[currentSemester]?.find(c =&gt; c.id === selectedCourseId), [currentSemester, selectedCourseId]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleContactClick = (role, name) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>setContactTarget({ name, role });</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><span class="Apple-converted-space">  </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleContactSelection = (type) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (contactTarget) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>onComposeMessage({ to: contactTarget.name, context: currentCourse.name, type: type });</p>
<p class="p1"><span class="Apple-converted-space">      </span>setContactTarget(null);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleBackToGrid = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (initialCourse &amp;&amp; onBack) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>onBack();</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">      </span>setViewMode('grid');</p>
<p class="p1"><span class="Apple-converted-space">      </span>setSelectedCourseId(null);</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><span class="Apple-converted-space">  </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleUpload = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Mock upload process</p>
<p class="p1"><span class="Apple-converted-space">      </span>alert("檔案上傳成功！");</p>
<p class="p1"><span class="Apple-converted-space">      </span>setShowUploadModal(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>if (viewMode === 'grid') {</p>
<p class="p1"><span class="Apple-converted-space">    </span>return (</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex justify-between items-end mb-4 border-b border-[#e0dad0] pb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2 className="font-serif text-lg font-bold text-[#4a4a4a]"&gt;課程儀表板&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p className="text-[#8c8c8c] text-xs font-light tracking-wide mt-1"&gt;請選擇學期以瀏覽課程。&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;select<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">              </span>value={currentSemester}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">              </span>onChange={(e) =&gt; setCurrentSemester(e.target.value)}</p>
<p class="p1"><span class="Apple-converted-space">              </span>className="appearance-none bg-[#fdfcfb] border border-[#d6ccc2] text-[#5c5c5c] py-1.5 pl-3 pr-8 rounded-full leading-tight focus:outline-none focus:ring-1 focus:ring-[#8da399] font-medium text-sm shadow-sm cursor-pointer hover:bg-[#f7f5f0] transition-colors"</p>
<p class="p1"><span class="Apple-converted-space">            </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>{SEMESTERS.map(s =&gt; &lt;option key={s} value={s}&gt;{s} 學期&lt;/option&gt;)}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;ChevronDown className="absolute right-3 top-2.5 text-[#8c8c8c] pointer-events-none" size={14}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>{(!COURSES_DATA[currentSemester] || COURSES_DATA[currentSemester].length === 0) ? (</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="flex-1 flex flex-col items-center justify-center text-[#b0b0b0] border-2 border-dashed border-[#e0dad0] rounded-2xl m-4 bg-[#f9f8f6]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;BookOpen size={48} className="mb-4 opacity-30" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p className="text-sm font-serif"&gt;本學期尚無課程資料&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 overflow-y-auto pb-10 pr-2 custom-scrollbar"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>{COURSES_DATA[currentSemester].map(course =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>key={course.id}</p>
<p class="p1"><span class="Apple-converted-space">                </span>onClick={() =&gt; { setSelectedCourseId(course.id); setViewMode('detail'); }}</p>
<p class="p1"><span class="Apple-converted-space">                </span>className="group bg-[#ffffff] rounded-2xl shadow-[0_4px_15px_-5px_rgba(0,0,0,0.05)] border border-[#f0f0f0] overflow-hidden cursor-pointer hover:shadow-[0_10px_25px_-5px_rgba(0,0,0,0.1)] hover:-translate-y-0.5 transition-all duration-300 flex flex-col h-40"</p>
<p class="p1"><span class="Apple-converted-space">              </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className={`h-12 ${course.style.cover} relative px-4 flex items-center justify-between overflow-hidden`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;div className="absolute top-0 right-0 w-full h-full bg-gradient-to-bl from-white/10 to-transparent"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;span className="relative z-10 bg-[#ffffff]/30 backdrop-blur-md px-2 py-0.5 rounded-full text-[10px] font-bold text-white tracking-widest"&gt;{course.code}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;span className="relative z-10 bg-[#ffffff]/30 backdrop-blur-md px-2 py-0.5 rounded-full text-[10px] font-bold text-white"&gt;{course.type}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="p-4 flex-1 flex flex-col justify-between bg-[#ffffff]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;h3 className="font-serif text-base font-bold text-[#4a4a4a] mb-1 group-hover:text-[#8da399] transition-colors leading-snug line-clamp-1"&gt;{course.name}&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div className="flex items-center text-[#8c8c8c] text-xs gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span className="flex items-center"&gt;&lt;User size={12} className="mr-1 text-[#b0b0b0]"/&gt; {course.professor}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;span className="flex items-center"&gt;&lt;MapPin size={12} className="mr-1 text-[#b0b0b0]"/&gt; {course.location}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;div className="pt-2 border-t border-[#f7f5f0] flex justify-between items-center mt-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;span className="text-[10px] font-bold text-[#b0b0b0] uppercase tracking-widest"&gt;進入課程&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;ChevronRight size={14} className="text-[#d6ccc2] group-hover:text-[#8da399] transition-colors"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>))}</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>)}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>if (!currentCourse) return null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="h-full flex flex-col animate-in slide-in-from-right-8 duration-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex items-center mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;button onClick={handleBackToGrid} className="flex items-center text-[#8c8c8c] hover:text-[#4a4a4a] hover:bg-[#f2f0e9] px-3 py-1.5 rounded-full transition-colors mr-3 group"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;ChevronLeft size={16} className="mr-1 group-hover:-translate-x-1 transition-transform"/&gt; &lt;span className="font-medium text-xs"&gt;返回列表&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span className="text-[#b0b0b0] font-light text-xs mx-2"&gt;/&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span className="text-[#8c8c8c] font-medium text-xs"&gt;{currentSemester}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span className="text-[#b0b0b0] font-light text-xs mx-2"&gt;/&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;span className="text-[#4a4a4a] font-bold tracking-wide text-sm"&gt;{currentCourse.name}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Simplified Course Header - More compact as requested */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="bg-[#ffffff] px-6 py-4 rounded-xl border border-[#f0f0f0] shadow-sm mb-4 flex justify-between items-center relative overflow-hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className={`absolute top-0 right-0 w-2 h-full ${currentCourse.style.cover}`}&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="flex items-center space-x-2 mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;span className={`px-2 py-0.5 rounded text-[10px] font-bold text-white tracking-widest ${currentCourse.style.cover}`}&gt;{currentCourse.code}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;span className="text-[#8c8c8c] text-[10px] font-medium bg-[#f7f5f0] px-2 py-0.5 rounded"&gt;{currentCourse.location}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;span className="text-[#8c8c8c] text-[10px] font-medium bg-[#f7f5f0] px-2 py-0.5 rounded"&gt;{currentCourse.type}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;h1 className="font-serif text-lg font-bold text-[#4a4a4a] tracking-tight"&gt;{currentCourse.name}&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;Button variant="secondary" className="px-3 py-1.5 text-xs h-8" onClick={() =&gt; handleContactClick('教師', currentCourse.professor)}&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;User size={14} /&gt; &lt;span className="text-xs"&gt;教師&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;Button variant="secondary" className="px-3 py-1.5 text-xs h-8" onClick={() =&gt; handleContactClick('助教', currentCourse.ta)}&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;Users size={14} /&gt; &lt;span className="text-xs"&gt;助教&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex flex-col h-full overflow-hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex space-x-4 mb-4 px-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{[{id:'announcement', l:'公告', i: Megaphone}, {id:'materials', l:'教材', i: BookOpen}, {id:'homework', l:'作業上傳', i: Upload}].map(tab =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button</p>
<p class="p1"><span class="Apple-converted-space">              </span>key={tab.id}</p>
<p class="p1"><span class="Apple-converted-space">              </span>onClick={() =&gt; setActiveTab(tab.id)}</p>
<p class="p1"><span class="Apple-converted-space">              </span>className={`pb-2 text-sm font-bold flex items-center space-x-2 transition-all relative ${activeTab === tab.id ? 'text-[#8da399]' : 'text-[#9e9e9e] hover:text-[#7a7a7a]'}`}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;tab.i size={16}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;span className="tracking-widest text-xs"&gt;{tab.l}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>{activeTab === tab.id &amp;&amp; &lt;span className="absolute bottom-0 left-0 w-full h-0.5 bg-[#8da399] rounded-full"&gt;&lt;/span&gt;}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>))}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex-1 bg-[#ffffff] rounded-2xl border border-[#f0f0f0] shadow-sm overflow-y-auto custom-scrollbar p-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{/* 2-Column Layout for Better Readability */}</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="p-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>{activeTab === 'announcement' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div className="grid grid-cols-1 lg:grid-cols-2 gap-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="border border-[#e0d6c1] bg-[#fdf2d9]/30 p-5 rounded-xl h-fit"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="flex justify-between items-start mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="p-1.5 bg-[#fdf2d9] rounded-full text-[#9c7b4f]"&gt;&lt;AlertCircle size={16}/&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;span className="font-serif font-bold text-base text-[#5c5c5c]"&gt;期中考範圍更動&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span className="text-[10px] font-bold text-[#9c7b4f] bg-[#fdf2d9] px-2 py-0.5 rounded-full tracking-widest"&gt;2025.05.10&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="pl-8"&gt;&lt;p className="text-[#5c5c5c] leading-loose text-sm font-light"&gt;各位同學好，原本預計考到第五章的範圍，現修正為&lt;strong className="font-bold text-[#4a4a4a]"&gt;考到第四章結束&lt;/strong&gt;。請大家告訴大家！&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* More mock announcements */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="border border-[#b6c7d6] bg-[#dbe4ea]/30 p-5 rounded-xl h-fit"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="flex justify-between items-start mb-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center space-x-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="p-1.5 bg-[#dbe4ea] rounded-full text-[#5d707f]"&gt;&lt;Info size={16}/&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;span className="font-serif font-bold text-base text-[#5c5c5c]"&gt;課程異動通知&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span className="text-[10px] font-bold text-[#5d707f] bg-[#dbe4ea] px-2 py-0.5 rounded-full tracking-widest"&gt;2025.05.01&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="pl-8"&gt;&lt;p className="text-[#5c5c5c] leading-loose text-sm font-light"&gt;下週三 (5/17) 的課程將改為線上進行，連結已發送至各位信箱，請準時上線。&lt;/p&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>)}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>{activeTab === 'materials' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>{[1,2,3,4,5,6].map(i =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;div key={i} className="flex items-center p-3 border border-[#f0f0f0] rounded-xl hover:border-[#d6b5b5] cursor-pointer group transition-all bg-[#faf9f6]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div className="w-10 h-10 bg-[#eadcdb] text-[#8c5e5e] rounded-lg flex items-center justify-center mr-3 shadow-sm"&gt;&lt;FileText size={20} /&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div className="flex-1 min-w-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;div className="font-serif font-bold text-sm text-[#4a4a4a] mb-0.5 truncate"&gt;Week {i} 課程講義&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;div className="text-[10px] text-[#9e9e9e] font-light"&gt;2.4 MB&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;button className="p-1.5 rounded-full text-[#b0b0b0] hover:bg-[#eadcdb] hover:text-[#8c5e5e] transition-all"&gt;&lt;Download size={16}/&gt;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>))}</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>)}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>{activeTab === 'homework' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div className="space-y-3 max-w-4xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="flex flex-col md:flex-row justify-between items-center p-5 border-l-4 border-l-[#d1c4a9] bg-[#fdfcfb] rounded-r-xl shadow-sm hover:shadow-md transition-shadow"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div className="flex items-center gap-4 mb-3 md:mb-0 w-full md:w-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="w-10 h-10 rounded-full bg-[#f0eadd] flex items-center justify-center text-[#8a7a5c]"&gt;&lt;AlertCircle size={20} /&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;h4 className="font-serif font-bold text-base text-[#4a4a4a] mb-0.5"&gt;期中報告草稿&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;div className="flex items-center gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;span className="text-[#8a7a5c] font-bold text-xs bg-[#f0eadd]/50 px-2 py-0.5 rounded"&gt;截止: 2025.05.15&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;span className="text-[#9e9e9e] text-[10px]"&gt;未繳交&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;Button variant="primary" icon={Upload} className="text-xs px-4 py-2 w-full md:w-auto" onClick={() =&gt; setShowUploadModal(true)}&gt;上傳檔案&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                  </span></p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="flex flex-col md:flex-row justify-between items-center p-5 border border-[#f0f0f0] rounded-xl bg-[#faf9f6] opacity-75 hover:opacity-100 transition-opacity"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div className="flex items-center gap-4 mb-3 md:mb-0 w-full md:w-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="w-10 h-10 rounded-full bg-[#dce5dd] flex items-center justify-center text-[#5c7a63]"&gt;&lt;Check size={20} /&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;h4 className="font-serif font-bold text-base text-[#4a4a4a] mb-0.5"&gt;第一次作業：文獻回顧&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;div className="flex items-center gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;span className="text-[#5c7a63] font-bold text-xs"&gt;已繳交 (95分)&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                             </span>&lt;span className="text-[#9e9e9e] text-[10px]"&gt;2025.03.20&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;Button variant="secondary" className="text-xs px-4 py-2 w-full md:w-auto" onClick={() =&gt; setShowFeedbackModal(true)}&gt;查看回饋&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>)}</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Upload Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={showUploadModal} onClose={() =&gt; setShowUploadModal(false)} title="上傳作業檔案"&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div className="border-2 border-dashed border-[#e0dad0] rounded-2xl p-8 flex flex-col items-center justify-center text-[#9e9e9e] hover:bg-[#faf9f6] transition-colors cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;Upload size={32} className="mb-2 text-[#b0b0b0]"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;p className="text-sm font-bold text-[#5c5c5c]"&gt;點擊選擇檔案 或 拖曳至此&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;p className="text-xs text-[#b0b0b0] mt-1"&gt;支援格式：PDF, Word, JPG (上限 10MB)&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div className="flex justify-end pt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;Button onClick={handleUpload}&gt;確認上傳&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Feedback Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={showFeedbackModal} onClose={() =&gt; setShowFeedbackModal(false)} title="作業回饋：文獻回顧"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="space-y-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div className="flex items-center gap-4 p-4 bg-[#fdfcfb] border border-[#f0f0f0] rounded-xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="w-12 h-12 rounded-full bg-[#dce5dd] flex items-center justify-center text-[#5c7a63] font-bold text-lg"&gt;95&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;h4 className="text-sm font-bold text-[#4a4a4a]"&gt;總分&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;p className="text-xs text-[#8c8c8c]"&gt;評分日期：2025.03.25&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div className="bg-[#faf9f6] p-5 rounded-xl"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;h4 className="text-xs font-bold text-[#b0b0b0] uppercase tracking-widest mb-3 flex items-center gap-1"&gt;&lt;MessageSquare size={12}/&gt; 助教評語&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;p className="text-sm text-[#5c5c5c] leading-loose"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>同學您好，您的報告架構非常完整，文獻引用的格式也都正確無誤。特別是在第二章節對於實驗設計的探討非常有深度，展現了良好的批判性思考能力。唯一的小建議是結論部分可以再精簡一些，突出重點會更好。繼續保持！</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;Button variant="secondary" className="w-full" onClick={() =&gt; setShowFeedbackModal(false)}&gt;關閉&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Contact Choice Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={!!contactTarget} onClose={() =&gt; setContactTarget(null)} title={`聯絡${contactTarget?.role}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;p className="text-sm text-[#5c5c5c] text-center mb-2"&gt;請問您想要如何聯絡 {contactTarget?.name}？&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div className="grid grid-cols-2 gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>className="p-4 border border-[#e0dad0] rounded-xl flex flex-col items-center justify-center cursor-pointer hover:bg-[#faf9f6] transition-all group"</p>
<p class="p1"><span class="Apple-converted-space">                    </span>onClick={() =&gt; handleContactSelection('email')}</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="w-12 h-12 bg-[#f4f1ea] rounded-full flex items-center justify-center text-[#6b6b6b] group-hover:scale-110 transition-transform mb-2"&gt;&lt;Mail size={24}/&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;span className="font-bold text-sm text-[#4a4a4a]"&gt;寄送信件&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;span className="text-xs text-[#9e9e9e] mt-1"&gt;正式詢問、請假&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                    </span>className="p-4 border border-[#e0dad0] rounded-xl flex flex-col items-center justify-center cursor-pointer hover:bg-[#faf9f6] transition-all group"</p>
<p class="p1"><span class="Apple-converted-space">                    </span>onClick={() =&gt; handleContactSelection('message')}</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="w-12 h-12 bg-[#eadcdb] rounded-full flex items-center justify-center text-[#8c5e5e] group-hover:scale-110 transition-transform mb-2"&gt;&lt;MessageSquare size={24}/&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;span className="font-bold text-sm text-[#4a4a4a]"&gt;傳送訊息&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;span className="text-xs text-[#9e9e9e] mt-1"&gt;即時討論、簡短問題&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// --- TAB 4: MESSAGES (對話與訊息) ---</p>
<p class="p1">const MessageCenter = ({ onCompose }) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [subTab, setSubTab] = useState('inbox');<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>const [isFabOpen, setIsFabOpen] = useState(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [selectedMessage, setSelectedMessage] = useState(null);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const activeList = MOCK_MESSAGES_DATA[subTab] || [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="h-full flex bg-[#ffffff] rounded-2xl border border-[#f0f0f0] shadow-sm overflow-hidden relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Sidebar */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="w-72 border-r border-[#f0f0f0] flex flex-col bg-[#faf9f6]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="p-4 border-b border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="grid grid-cols-2 gap-2 bg-[#f0eadd]/50 p-1 rounded-lg mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>{['chat', 'inbox', 'sent', 'drafts'].map(t =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;button<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>key={t}</p>
<p class="p1"><span class="Apple-converted-space">                </span>onClick={() =&gt; { setSubTab(t); setSelectedMessage(null); }}</p>
<p class="p1"><span class="Apple-converted-space">                </span>className={`py-1.5 text-[10px] font-bold rounded-md capitalize transition-all ${subTab === t ? 'bg-[#ffffff] shadow-sm text-[#5c5c5c]' : 'text-[#9e9e9e]'}`}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{t === 'chat' ? '訊息' : t === 'inbox' ? '收件匣' : t === 'sent' ? '寄件備份' : '草稿'}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>))}</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;Search className="absolute left-3 top-2.5 text-[#b0b0b0]" size={16} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;input type="text" placeholder="搜尋..." className="w-full bg-[#ffffff] border border-[#e0dad0] rounded-full pl-10 pr-3 py-2 text-xs focus:outline-none focus:ring-1 focus:ring-[#8da399] text-[#5c5c5c]"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex-1 overflow-y-auto"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>{activeList.map(item =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">               </span>key={item.id}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">               </span>onClick={() =&gt; setSelectedMessage(item)}</p>
<p class="p1"><span class="Apple-converted-space">               </span>className={`p-4 border-b border-[#f7f5f0] cursor-pointer transition-colors group ${selectedMessage?.id === item.id ? 'bg-[#ffffff] border-l-4 border-l-[#8da399]' : 'hover:bg-[#ffffff]'}`}</p>
<p class="p1"><span class="Apple-converted-space">             </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div className="flex justify-between mb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;span className={`font-serif font-bold text-sm ${!item.read &amp;&amp; !item.messages ? 'text-[#8da399]' : 'text-[#4a4a4a]'}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{subTab === 'chat' ? item.name : item.sender}</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;span className="text-[10px] text-[#b0b0b0]"&gt;{item.time}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div className="text-[10px] text-[#8c8c8c] line-clamp-1 font-light"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>{subTab === 'chat' ? item.lastMsg : item.subject}</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>))}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Main Reading Area */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div className="flex-1 flex flex-col relative bg-[#ffffff]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>{!selectedMessage ? (</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="flex-1 flex flex-col items-center justify-center text-[#d6ccc2]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;MessageSquare size={48} className="mb-4 opacity-20" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;p className="font-serif text-sm"&gt;請選擇一則訊息以閱讀&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="flex-1 flex flex-col h-full"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* Header */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="h-16 border-b border-[#f0f0f0] flex items-center justify-between px-6 flex-shrink-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{subTab === 'chat' ? (</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="w-8 h-8 rounded-full bg-[#e0dad0] flex items-center justify-center text-[#5c5c5c] font-bold"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>{selectedMessage.name[0]}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="p-2 bg-[#f4f1ea] rounded-full text-[#6b6b6b]"&gt;&lt;Mail size={16}/&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>)}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;h3 className="font-bold text-[#4a4a4a] text-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>{subTab === 'chat' ? selectedMessage.name : selectedMessage.subject}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>{subTab !== 'chat' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;p className="text-[10px] text-[#9e9e9e]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>寄件者: {selectedMessage.sender} {selectedMessage.email &amp;&amp; `&lt;${selectedMessage.email}&gt;`}</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>)}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="flex gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{subTab !== 'chat' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button className="p-1.5 hover:bg-[#f7f5f0] rounded text-[#8c8c8c]"&gt;&lt;Reply size={16}/&gt;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;button className="p-1.5 hover:bg-[#f7f5f0] rounded text-[#8c8c8c]"&gt;&lt;Trash2 size={16}/&gt;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>)}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* Content */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="flex-1 overflow-y-auto p-6 custom-scrollbar bg-[#faf9f6]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{subTab === 'chat' ? (</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>{selectedMessage.history.map(msg =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div key={msg.id} className={`flex ${msg.sender === 'me' ? 'justify-end' : 'justify-start'}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div className={`max-w-[70%] p-3 rounded-2xl text-xs leading-relaxed shadow-sm ${msg.sender === 'me' ? 'bg-[#8da399] text-white rounded-br-none' : 'bg-[#ffffff] text-[#5c5c5c] rounded-bl-none border border-[#f0f0f0]'}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>{msg.text}</p>
<p class="p1"><span class="Apple-converted-space">                                        </span>&lt;div className={`text-[9px] mt-1 text-right ${msg.sender === 'me' ? 'text-white/70' : 'text-[#b0b0b0]'}`}&gt;{msg.time}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="bg-white p-6 rounded-xl border border-[#f0f0f0] shadow-sm min-h-[300px]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="flex justify-between items-start mb-6 border-b border-[#f7f7f7] pb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div className="space-y-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div className="text-xs text-[#8c8c8c]"&gt;&lt;span className="font-bold"&gt;收件者:&lt;/span&gt; {selectedMessage.recipient || '我'}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;div className="text-xs text-[#8c8c8c]"&gt;&lt;span className="font-bold"&gt;日期:&lt;/span&gt; {selectedMessage.time}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="text-sm text-[#5c5c5c] leading-loose whitespace-pre-wrap font-light"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>{selectedMessage.content}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>{/* Mock Attachment */}</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="mt-8 pt-4 border-t border-[#f7f7f7]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;div className="inline-flex items-center gap-2 p-2 border border-[#e0dad0] rounded-lg bg-[#f9f8f6] cursor-pointer hover:bg-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;File size={16} className="text-[#8da399]"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span className="text-xs text-[#5c5c5c]"&gt;附件.pdf&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>)}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* Footer Input (Chat only) */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>{subTab === 'chat' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="p-4 bg-[#ffffff] border-t border-[#f0f0f0] flex gap-2 items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button className="p-2 text-[#b0b0b0] hover:text-[#8da399]"&gt;&lt;Plus size={20}/&gt;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;input type="text" placeholder="輸入訊息..." className="flex-1 bg-[#f9f8f6] border-none rounded-full px-4 py-2 text-sm focus:ring-1 focus:ring-[#8da399] text-[#5c5c5c]"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;button className="p-2 bg-[#8da399] text-white rounded-full hover:bg-[#7a8f85]"&gt;&lt;SendIcon size={16}/&gt;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>)}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>)}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>{/* Floating Action Button (Speed Dial) */}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="absolute bottom-8 right-8 flex flex-col items-end gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>{isFabOpen &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;button onClick={() =&gt; onCompose({ type: 'email' })} className="flex items-center gap-2 bg-[#f4f1ea] px-3 py-1.5 rounded-full shadow-md text-[#5c5c5c] text-xs font-bold hover:bg-[#e8e4db] animate-in slide-in-from-bottom-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;Mail size={14}/&gt; 撰寫郵件</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;button onClick={() =&gt; onCompose({ type: 'message' })} className="flex items-center gap-2 bg-[#f4f1ea] px-3 py-1.5 rounded-full shadow-md text-[#5c5c5c] text-xs font-bold hover:bg-[#e8e4db] animate-in slide-in-from-bottom-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;MessageSquare size={14}/&gt; 撰寫訊息</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>)}</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;button<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>onClick={() =&gt; setIsFabOpen(!isFabOpen)}</p>
<p class="p1"><span class="Apple-converted-space">             </span>className={`w-12 h-12 bg-[#8da399] text-white rounded-full shadow-lg flex items-center justify-center hover:scale-110 transition-all hover:bg-[#7a8f85] ${isFabOpen ? 'rotate-45' : ''}`}</p>
<p class="p1"><span class="Apple-converted-space">           </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;Plus size={24} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// --- TAB 5: GRADES (成績查看) ---</p>
<p class="p1">const GradebookView = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [currentSemester, setCurrentSemester] = useState('114-2');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [expandedCourses, setExpandedCourses] = useState([]); // Track expanded IDs</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showDistribution, setShowDistribution] = useState(null);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showCalculator, setShowCalculator] = useState(null); // Changed to store course calculation data</p>
<p class="p1"><span class="Apple-converted-space">  </span>const courses = COURSES_DATA[currentSemester] || [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const toggleCourse = (id) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>setExpandedCourses(prev =&gt;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>prev.includes(id) ? prev.filter(cId =&gt; cId !== id) : [...prev, id]</p>
<p class="p1"><span class="Apple-converted-space">    </span>);</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const getMockScores = (courseId) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const hash = courseId.split('').reduce((acc, char) =&gt; acc + char.charCodeAt(0), 0);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const score = 60 + (hash % 40);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">    </span>const isHidden = (hash % 5) === 0; // Randomly hide some distributions</p>
<p class="p1"><span class="Apple-converted-space">    </span>// Generate dynamic five-number summary based on score</p>
<p class="p1"><span class="Apple-converted-space">    </span>const fiveSummary = {</p>
<p class="p1"><span class="Apple-converted-space">        </span>top: Math.min(100, score + 15),</p>
<p class="p1"><span class="Apple-converted-space">        </span>front: Math.min(100, score + 8),</p>
<p class="p1"><span class="Apple-converted-space">        </span>avg: score - 2,</p>
<p class="p1"><span class="Apple-converted-space">        </span>back: Math.max(0, score - 10),</p>
<p class="p1"><span class="Apple-converted-space">        </span>bottom: Math.max(0, score - 20)</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Generate assignments for calculation</p>
<p class="p1"><span class="Apple-converted-space">    </span>const assignments = [</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ name: '作業一', weight: 10, score: Math.min(100, score + 5) },</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ name: '作業二', weight: 10, score: Math.min(100, score + 2) },</p>
<p class="p1"><span class="Apple-converted-space">        </span>{ name: '課堂參與', weight: 10, score: 90 }</p>
<p class="p1"><span class="Apple-converted-space">    </span>];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const midterm = { weight: 30, score: Math.min(100, score - 5) };</p>
<p class="p1"><span class="Apple-converted-space">    </span>const final = { weight: 40, score: score &gt; 90 ? '--' : Math.min(100, score + 2) };</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>return {</p>
<p class="p1"><span class="Apple-converted-space">      </span>total: score,</p>
<p class="p1"><span class="Apple-converted-space">      </span>assignments,</p>
<p class="p1"><span class="Apple-converted-space">      </span>midterm,</p>
<p class="p1"><span class="Apple-converted-space">      </span>final,</p>
<p class="p1"><span class="Apple-converted-space">      </span>// Mapping old properties for compatibility</p>
<p class="p1"><span class="Apple-converted-space">      </span>assignment: assignments[0].score,<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>isHidden,</p>
<p class="p1"><span class="Apple-converted-space">      </span>rank: Math.floor((100 - score) / 2) + 1,</p>
<p class="p1"><span class="Apple-converted-space">      </span>midtermRank: Math.floor((100 - score) / 2) + 3,</p>
<p class="p1"><span class="Apple-converted-space">      </span>finalRank: Math.floor((100 - score) / 2) + 2,</p>
<p class="p1"><span class="Apple-converted-space">      </span>fiveSummary</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Calculate Historical Stats (All semesters)</p>
<p class="p1"><span class="Apple-converted-space">  </span>const historicalStats = useMemo(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>let totalScore = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>let totalCredits = 0;</p>
<p class="p1"><span class="Apple-converted-space">    </span>Object.values(COURSES_DATA).forEach(semesterCourses =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>semesterCourses.forEach(course =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">        </span>const scores = getMockScores(course.id);</p>
<p class="p1"><span class="Apple-converted-space">        </span>totalScore += scores.total * 3;<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>totalCredits += 3;</p>
<p class="p1"><span class="Apple-converted-space">      </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">    </span>return {</p>
<p class="p1"><span class="Apple-converted-space">      </span>avg: totalCredits ? (totalScore / totalCredits).toFixed(1) : 0,</p>
<p class="p1"><span class="Apple-converted-space">      </span>credits: totalCredits,</p>
<p class="p1"><span class="Apple-converted-space">      </span>title: '歷年總成績分佈',</p>
<p class="p1"><span class="Apple-converted-space">      </span>isHidden: false,</p>
<p class="p1"><span class="Apple-converted-space">      </span>isHistorical: true,</p>
<p class="p1"><span class="Apple-converted-space">      </span>fiveSummary: { top: 92, front: 85, avg: 78, back: 70, bottom: 60 },</p>
<p class="p1"><span class="Apple-converted-space">      </span>rank: 5, // Mock rank</p>
<p class="p1"><span class="Apple-converted-space">      </span>totalRank: 42 // Added Total Rank</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}, []);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>// Determine user relative position string</p>
<p class="p1"><span class="Apple-converted-space">  </span>const getUserPosition = (score, fiveSummary, isHidden) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (isHidden) return "";</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (score &gt;= fiveSummary.top) return "您的成績位於 頂標 以上";</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (score &gt;= fiveSummary.front) return "您的成績位於 前標 與 頂標 之間";</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (score &gt;= fiveSummary.avg) return "您的成績位於 均標 與 前標 之間";</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (score &gt;= fiveSummary.back) return "您的成績位於 後標 與 均標 之間";</p>
<p class="p1"><span class="Apple-converted-space">    </span>return "您的成績位於 底標 與 後標 之間";</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="h-full flex flex-col animate-in fade-in slide-in-from-bottom-4 duration-500"&gt;</p>
<p class="p2"><span class="Apple-converted-space">       </span></p>
<p class="p1"><span class="Apple-converted-space">       </span>{/* 1. Historical Summary Block */}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">         </span>className="bg-[#8da399] rounded-2xl p-6 text-white mb-6 shadow-md flex justify-between items-center relative overflow-hidden cursor-pointer hover:brightness-105 transition-all"</p>
<p class="p1"><span class="Apple-converted-space">         </span>onClick={() =&gt; setShowDistribution(historicalStats)}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="absolute right-0 top-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/4"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;h3 className="text-xs font-bold text-white/80 uppercase tracking-widest mb-1 flex items-center gap-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>歷年學業總覽 &lt;TrendingUp size={12}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div className="flex items-end gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;span className="text-4xl font-serif font-bold"&gt;{historicalStats.avg}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;span className="text-xs text-white/70 ml-1"&gt;累積平均&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="h-8 w-px bg-white/30 mx-2"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;span className="text-2xl font-serif font-bold"&gt;{historicalStats.credits}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;span className="text-xs text-white/70 ml-1"&gt;實得學分&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="h-8 w-px bg-white/30 mx-2"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span className="text-2xl font-serif font-bold"&gt;#{historicalStats.rank}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span className="text-xs text-white/70 ml-1"&gt;系排名&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* NEW: Total Rank */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="h-8 w-px bg-white/30 mx-2"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span className="text-2xl font-serif font-bold"&gt;#{historicalStats.totalRank}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span className="text-xs text-white/70 ml-1"&gt;總排名&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;Award size={48} className="text-white/20"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">       </span>{/* 2. Semester Selector &amp; Warning Badge */}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;div className="flex justify-between items-center mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="flex items-center gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;h2 className="font-serif text-lg font-bold text-[#4a4a4a]"&gt;學期成績明細&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;span className="text-[10px] font-bold text-red-600 bg-red-50 px-2 py-1 rounded-lg border border-red-100 flex items-center gap-1 animate-pulse"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;AlertTriangle size={12}/&gt; 預警中：性格心理學</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;div className="relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;select<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">              </span>value={currentSemester}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">              </span>onChange={(e) =&gt; setCurrentSemester(e.target.value)}</p>
<p class="p1"><span class="Apple-converted-space">              </span>className="appearance-none bg-[#fdfcfb] border border-[#d6ccc2] text-[#5c5c5c] py-1.5 pl-3 pr-8 rounded-full font-bold shadow-sm cursor-pointer hover:bg-[#f7f5f0] text-sm"</p>
<p class="p1"><span class="Apple-converted-space">            </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>{SEMESTERS.map(s =&gt; &lt;option key={s} value={s}&gt;{s} 學期&lt;/option&gt;)}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;ChevronDown className="absolute right-3 top-2.5 text-[#8c8c8c] pointer-events-none" size={14}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;div className="space-y-3 overflow-y-auto pb-10 custom-scrollbar pr-2 flex-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>{courses.length === 0 ? (</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="p-8 text-center text-[#b0b0b0] border-2 border-dashed border-[#e0dad0] rounded-2xl"&gt;尚無成績資料&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">           </span>courses.map(course =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">             </span>const scores = getMockScores(course.id);</p>
<p class="p1"><span class="Apple-converted-space">             </span>const isExpanded = expandedCourses.includes(course.id);</p>
<p class="p2"><span class="Apple-converted-space">             </span></p>
<p class="p1"><span class="Apple-converted-space">             </span>return (</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;Card key={course.id} className={`overflow-hidden border border-[#f0f0f0] shadow-sm transition-all ${isExpanded ? 'ring-1 ring-[#d6ccc2]' : ''}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>{/* Collapsible Header */}</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                   </span>className="p-4 flex justify-between items-center cursor-pointer hover:bg-[#faf9f6] transition-colors"</p>
<p class="p1"><span class="Apple-converted-space">                   </span>onClick={() =&gt; toggleCourse(course.id)}</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;div className={`w-1 h-8 rounded-full ${course.style.cover}`}&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;h3 className="font-serif font-bold text-[#4a4a4a] text-base"&gt;{course.name}&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div className="text-[10px] text-[#9e9e9e] flex items-center gap-2 mt-0.5"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span className="bg-[#f7f5f0] px-1.5 py-0.5 rounded border border-[#e0dad0]"&gt;{course.type}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;span&gt;{course.professor}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="flex items-center gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>{/* Calculator Trigger */}</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                         </span>className="text-right group cursor-pointer"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                         </span>onClick={(e) =&gt; {<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                           </span>e.stopPropagation();<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                           </span>setShowCalculator({ title: `${course.name} 成績計算細則`, ...scores });</p>
<p class="p1"><span class="Apple-converted-space">                         </span>}}</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;div className="text-xl font-serif font-bold text-[#8da399] group-hover:text-[#7a8f85] transition-colors"&gt;{scores.total}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;div className="text-[9px] text-[#b0b0b0] underline decoration-dotted"&gt;目前積分 (點擊查看)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                       </span></p>
<p class="p1"><span class="Apple-converted-space">                       </span>{/* Distribution Trigger */}</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;div<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                          </span>className="p-2 rounded-full hover:bg-[#f0eadd] text-[#b0b0b0] hover:text-[#8a7a5c] cursor-pointer transition-colors"</p>
<p class="p1"><span class="Apple-converted-space">                          </span>onClick={(e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                            </span>e.stopPropagation();</p>
<p class="p1"><span class="Apple-converted-space">                            </span>setShowDistribution({title: `${course.name} - 總成績分佈`, score: scores.total, fiveSummary: scores.fiveSummary, ...scores});</p>
<p class="p1"><span class="Apple-converted-space">                          </span>}}</p>
<p class="p1"><span class="Apple-converted-space">                          </span>title="查看五標與分佈"</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;BarChart2 size={18} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                       </span>{isExpanded ? &lt;ChevronUp size={18} className="text-[#b0b0b0]"/&gt; : &lt;ChevronDown size={18} className="text-[#b0b0b0]"/&gt;}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                 </span>{/* Expanded Details */}</p>
<p class="p1"><span class="Apple-converted-space">                 </span>{isExpanded &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;div className="px-5 pb-5 pt-2 bg-[#fcfcfc] border-t border-[#f7f7f7] animate-in slide-in-from-top-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="grid grid-cols-2 gap-4 mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div className="p-3 bg-[#ffffff] border border-[#f0f0f0] rounded-xl text-center cursor-pointer hover:border-[#d6ccc2]" onClick={() =&gt; setShowDistribution({title: '期中考分佈', score: scores.midterm.score, fiveSummary: { top: 90, front: 80, avg: 70, back: 60, bottom: 50 }, ...scores})}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="text-[10px] text-[#9e9e9e] mb-1"&gt;期中考&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="text-lg font-bold text-[#5c5c5c]"&gt;{scores.midterm.score}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="text-[9px] text-[#b0b0b0] mt-1"&gt;排名 {scores.midtermRank}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div className="p-3 bg-[#ffffff] border border-[#f0f0f0] rounded-xl text-center cursor-pointer hover:border-[#d6ccc2]" onClick={() =&gt; setShowDistribution({title: '期末考分佈', score: scores.final.score, fiveSummary: { top: 88, front: 78, avg: 68, back: 58, bottom: 48 }, ...scores})}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="text-[10px] text-[#9e9e9e] mb-1"&gt;期末考&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="text-lg font-bold text-[#5c5c5c]"&gt;{scores.final.score}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>&lt;div className="text-[9px] text-[#b0b0b0] mt-1"&gt;排名 {scores.finalRank}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">                      </span></p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;h4 className="text-[10px] font-bold text-[#b0b0b0] uppercase tracking-widest mb-2 flex items-center"&gt;&lt;FileText size={12} className="mr-1"/&gt; 平時作業細項&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;div className="space-y-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>{scores.assignments.map((hw, i) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;div key={i} className="flex justify-between items-center p-2 bg-[#ffffff] border border-[#f7f7f7] rounded-lg text-xs cursor-pointer hover:bg-[#faf9f6]" onClick={() =&gt; setShowDistribution({title: `${hw.name} 分佈`, score: hw.score, fiveSummary: { top: 95, front: 85, avg: 75, back: 65, bottom: 55 }, ...scores})}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                 </span>&lt;span className="text-[#5c5c5c] font-medium"&gt;{hw.name}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                 </span>&lt;div className="flex items-center gap-3"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span className="text-[#9e9e9e] text-[10px]"&gt;排名 {Math.floor(Math.random()*10)+1}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                    </span>&lt;span className="font-bold text-[#4a4a4a]"&gt;{hw.score}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                                 </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                            </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>)}</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/Card&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>);</p>
<p class="p1"><span class="Apple-converted-space">           </span>})</p>
<p class="p1"><span class="Apple-converted-space">         </span>)}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">       </span>{/* Distribution Modal */}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;Modal isOpen={!!showDistribution} onClose={() =&gt; setShowDistribution(null)} title={showDistribution?.title || '成績分佈'}&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{showDistribution?.isHidden ? (</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div className="flex flex-col items-center justify-center py-10 text-[#b0b0b0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;EyeOff size={48} className="mb-4 opacity-50"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p className="font-bold text-base"&gt;教師已隱藏成績分佈&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;p className="text-xs mt-2"&gt;此課程不公開排名與五標資訊&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div className="space-y-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* 5-Number Summary */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="bg-[#faf9f6] p-4 rounded-xl flex justify-between text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>{[</p>
<p class="p1"><span class="Apple-converted-space">                     </span>{ l: '頂標', v: showDistribution?.fiveSummary?.top || 88 },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                     </span>{ l: '前標', v: showDistribution?.fiveSummary?.front || 76 },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                     </span>{ l: '均標', v: showDistribution?.fiveSummary?.avg || 65 },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                     </span>{ l: '後標', v: showDistribution?.fiveSummary?.back || 52 },<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                     </span>{ l: '底標', v: showDistribution?.fiveSummary?.bottom || 40 }</p>
<p class="p1"><span class="Apple-converted-space">                   </span>].map(stat =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;div key={stat.l}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="text-[10px] text-[#9e9e9e] mb-1"&gt;{stat.l}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="font-serif font-bold text-[#5c5c5c] text-lg"&gt;{stat.v}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* Conditional Rendering: Historical Trend vs Distribution Chart */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>{showDistribution?.isHistorical ? (</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;h4 className="text-[10px] font-bold text-[#b0b0b0] uppercase tracking-widest mb-2 flex items-center"&gt;&lt;TrendingUp size={12} className="mr-1"/&gt; 排名走勢 (近四學期)&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="h-40 w-full relative border-l border-b border-[#e0dad0] flex items-end justify-between px-4 pb-0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>{/* SVG Trend Line */}</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;svg className="absolute top-0 left-0 w-full h-full overflow-visible pointer-events-none" style={{zIndex: 0}}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;polyline<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                             </span>fill="none"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                             </span>stroke="#dcb5b5"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                             </span>strokeWidth="3"<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                             </span>points="</p>
<p class="p1"><span class="Apple-converted-space">                               </span>20,120</p>
<p class="p1"><span class="Apple-converted-space">                               </span>120,90</p>
<p class="p1"><span class="Apple-converted-space">                               </span>220,60</p>
<p class="p1"><span class="Apple-converted-space">                               </span>320,60</p>
<p class="p1"><span class="Apple-converted-space">                             </span>"</p>
<p class="p1"><span class="Apple-converted-space">                          </span>/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>&lt;/svg&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>{/* Points */}</p>
<p class="p1"><span class="Apple-converted-space">                       </span>{['113-1', '113-2', '114-1', '114-2'].map((sem, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                         </span>const rank = [10, 8, 5, 5][i];<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                         </span>const yPos = (rank / 15) * 100; // approximation</p>
<p class="p1"><span class="Apple-converted-space">                         </span>return (</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;div key={sem} className="flex flex-col items-center group relative z-10"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;div className="w-3 h-3 bg-[#8c5e5e] rounded-full border-2 border-white shadow-sm mb-2" style={{marginBottom: `${(15-rank)*10}px`}}&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;span className="text-[10px] text-[#b0b0b0] mt-1"&gt;{sem}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;div className="absolute -top-16 text-xs font-bold text-[#8c5e5e] bg-white px-2 py-1 rounded shadow-sm opacity-0 group-hover:opacity-100 transition-opacity" style={{top: `${140 - (15-rank)*10}px`}}&gt;#{rank}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                         </span>)</p>
<p class="p1"><span class="Apple-converted-space">                       </span>})}</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="text-center text-[10px] text-[#8da399] mt-2 bg-[#8da399]/10 py-2 rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>恭喜！您的排名呈現穩定上升趨勢</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="h-40 flex items-end justify-between space-x-2 text-[10px] text-[#8c8c8c] px-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>{[5, 12, 35, 20, 8].map((h, i) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div key={i} className="w-full flex flex-col items-center group relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;div className="w-full bg-[#f0f0f0] rounded-t-md relative group-hover:bg-[#dbe4ea] transition-all" style={{height: `${h*3}px`}}&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                           </span>&lt;span className="mt-2 text-[#b0b0b0]"&gt;{['&lt;60','60-69','70-79','80-89','90+'][i]}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>)}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>{/* Score Position Text (Only for non-historical views) */}</p>
<p class="p1"><span class="Apple-converted-space">                </span>{!showDistribution?.isHistorical &amp;&amp; showDistribution?.score &amp;&amp; showDistribution?.fiveSummary &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="text-center pt-4 border-t border-[#f0f0f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;p className="text-sm font-bold text-[#8da399] bg-[#8da399]/10 py-2 rounded-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                       </span>{getUserPosition(showDistribution.score, showDistribution.fiveSummary, showDistribution.isHidden)}</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>)}</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>)}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;/Modal&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">       </span>{/* Calculation Breakdown Modal */}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;Modal isOpen={!!showCalculator} onClose={() =&gt; setShowCalculator(null)} title={showCalculator?.title}&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{showCalculator &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="bg-[#f9f8f6] p-4 rounded-xl border border-[#e0dad0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="flex justify-between text-xs font-bold text-[#b0b0b0] mb-2 border-b border-[#e0dad0] pb-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span&gt;項目&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right"&gt;權重&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right"&gt;得分&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right"&gt;折算&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>{showCalculator.assignments.map((hw, i) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;div key={i} className="flex justify-between text-sm text-[#5c5c5c] py-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;span&gt;{hw.name}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;span className="w-12 text-right"&gt;{hw.weight}%&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;span className="w-12 text-right"&gt;{hw.score}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                              </span>&lt;span className="w-12 text-right font-bold"&gt;{(hw.score * hw.weight / 100).toFixed(1)}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                      </span>{/* Midterm */}</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="flex justify-between text-sm text-[#5c5c5c] py-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span&gt;期中考&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right"&gt;{showCalculator.midterm.weight}%&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right"&gt;{showCalculator.midterm.score}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right font-bold"&gt;{(showCalculator.midterm.score * showCalculator.midterm.weight / 100).toFixed(1)}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>{/* Final */}</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="flex justify-between text-sm text-[#5c5c5c] py-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span&gt;期末考&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right"&gt;{showCalculator.final.weight}%&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right"&gt;{showCalculator.final.score === '--' ? '-' : showCalculator.final.score}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="w-12 text-right font-bold"&gt;{showCalculator.final.score === '--' ? '0.0' : (showCalculator.final.score * showCalculator.final.weight / 100).toFixed(1)}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div className="border-t border-[#e0dad0] mt-2 pt-2 flex justify-between items-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="font-bold text-[#4a4a4a]"&gt;目前總計&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                          </span>&lt;span className="text-xl font-serif font-bold text-[#8da399]"&gt;{showCalculator.total}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;p className="text-xs text-[#9e9e9e] text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>* 若期末考尚未登錄，總分將不包含期末考佔比。</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>)}</p>
<p class="p1"><span class="Apple-converted-space">       </span>&lt;/Modal&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">// --- MAIN APP COMPONENT ---</p>
<p class="p2"><br></p>
<p class="p1">const App = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [activeTab, setActiveTab] = useState('calendar');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showProfile, setShowProfile] = useState(false);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [selectedCourse, setSelectedCourse] = useState(null);</p>
<p class="p1"><span class="Apple-converted-space">  </span>const [composeData, setComposeData] = useState(null);<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">  </span>const [showNotifications, setShowNotifications] = useState(false);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const notificationRef = useRef(null);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>useEffect(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const handleClickOutside = (event) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>if (notificationRef.current &amp;&amp; !notificationRef.current.contains(event.target)) setShowNotifications(false);</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p1"><span class="Apple-converted-space">    </span>document.addEventListener('mousedown', handleClickOutside);</p>
<p class="p1"><span class="Apple-converted-space">    </span>return () =&gt; document.removeEventListener('mousedown', handleClickOutside);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}, []);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const handleNavigateToCourse = (course) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>setSelectedCourse(course);</p>
<p class="p1"><span class="Apple-converted-space">    </span>setActiveTab('dashboard');</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const renderContent = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">    </span>switch (activeTab) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>case 'calendar': return &lt;CalendarView onComposeMessage={setComposeData}/&gt;;</p>
<p class="p1"><span class="Apple-converted-space">      </span>case 'schedule': return &lt;ScheduleView onNavigateToCourse={handleNavigateToCourse} /&gt;;</p>
<p class="p1"><span class="Apple-converted-space">      </span>case 'dashboard': return &lt;CourseDashboard selectedCourse={selectedCourse} onBack={() =&gt; setActiveTab('schedule')} onComposeMessage={setComposeData} /&gt;;</p>
<p class="p1"><span class="Apple-converted-space">      </span>case 'messages': return &lt;MessageCenter onCompose={setComposeData} /&gt;;</p>
<p class="p1"><span class="Apple-converted-space">      </span>case 'grades': return &lt;GradebookView /&gt;;</p>
<p class="p1"><span class="Apple-converted-space">      </span>default: return null;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const NAV_ITEMS = [</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'calendar', icon: CalendarIcon, l: '行事曆' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'schedule', icon: Clock, l: '課表' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'dashboard', icon: BookOpen, l: '課程' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'messages', icon: MessageSquare, l: '訊息' },</p>
<p class="p1"><span class="Apple-converted-space">    </span>{ id: 'grades', icon: BarChart2, l: '成績' },</p>
<p class="p1"><span class="Apple-converted-space">  </span>];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>return (</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div className="flex h-screen bg-[#f9f8f6] text-[#4a4a4a] font-sans overflow-hidden selection:bg-[#d6cfc7] selection:text-white"&gt;</p>
<p class="p2"><span class="Apple-converted-space">      </span></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Sidebar */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;aside className="w-20 bg-[#ffffff] border-r border-[#f0f0f0] flex flex-col items-center py-6 z-20 shadow-sm"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>{/* Logo Section with ecourse3 text */}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="mb-8 flex flex-col items-center gap-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="p-2.5 bg-[#f7f5f0] rounded-xl text-[#8da399]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;BookOpen size={24} strokeWidth={1.5}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;span className="text-[10px] font-bold text-[#8da399] tracking-widest font-serif"&gt;ecourse3&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;nav className="flex-1 space-y-4 w-full px-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>{NAV_ITEMS.map(item =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">              </span>key={item.id}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">              </span>onClick={() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">                </span>setActiveTab(item.id);</p>
<p class="p1"><span class="Apple-converted-space">                </span>// Fix: Clear selectedCourse when clicking "Course" tab to show the dashboard grid</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (item.id === 'dashboard') {</p>
<p class="p1"><span class="Apple-converted-space">                  </span>setSelectedCourse(null);</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">              </span>}}</p>
<p class="p1"><span class="Apple-converted-space">              </span>className={`w-full flex flex-col items-center justify-center p-2.5 rounded-xl transition-all duration-300 group relative ${activeTab === item.id ? 'text-[#8da399] bg-[#f0eadd]/50' : 'text-[#b0b0b0] hover:text-[#8c8c8c] hover:bg-[#fcfcfc]'}`}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;item.icon size={20} strokeWidth={1.5} className={`mb-1 transition-transform duration-300 ${activeTab === item.id ? 'scale-110' : 'group-hover:scale-105'}`}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;span className="text-[9px] font-medium tracking-widest"&gt;{item.l}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>{activeTab === item.id &amp;&amp; &lt;div className="absolute left-0 top-1/2 -translate-y-1/2 w-1 h-6 bg-[#8da399] rounded-r-full"&gt;&lt;/div&gt;}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>))}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/nav&gt;</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>{/* Settings Only */}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="mt-auto flex flex-col items-center gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;button className="p-2.5 text-[#b0b0b0] hover:text-[#4a4a4a] transition-colors rounded-full hover:bg-[#f7f5f0]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;Settings size={20} strokeWidth={1.5}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/aside&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Main Area */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;main className="flex-1 flex flex-col relative min-w-0 bg-[#f9f8f6]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;header className="h-16 flex items-center justify-between px-8 z-40"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;h2 className="font-serif text-xl font-bold text-[#4a4a4a] tracking-tight"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>{activeTab === 'dashboard' ? 'Course Dashboard' : activeTab === 'calendar' ? 'Calendar' : activeTab === 'schedule' ? 'Schedule' : activeTab === 'messages' ? 'Messages' : 'Grades'}</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;span className="text-[9px] font-bold text-[#b0b0b0] tracking-[0.2em] uppercase mt-0.5"&gt;Academic Year 114&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="flex items-center gap-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div className="relative" ref={notificationRef}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button onClick={() =&gt; setShowNotifications(!showNotifications)} className={`relative p-1.5 transition-colors ${showNotifications ? 'text-[#8da399]' : 'text-[#b0b0b0] hover:text-[#4a4a4a]'}`}&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;Bell size={20} strokeWidth={1.5} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;span className="absolute top-2 right-2.5 w-2 h-2 bg-[#dcb5b5] rounded-full border-2 border-[#f9f8f6]"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>{showNotifications &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="absolute right-0 top-10 w-72 bg-[#ffffff] rounded-xl shadow-[0_10px_40px_-10px_rgba(0,0,0,0.1)] border border-[#f0f0f0] overflow-hidden animate-in fade-in zoom-in-95 z-50 p-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div className="text-[10px] font-bold text-[#b0b0b0] uppercase tracking-widest px-3 py-2 border-b border-[#f7f5f0]"&gt;Notifications&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>{MOCK_NOTIFICATIONS.map(notif =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;div key={notif.id} className="p-3 hover:bg-[#faf9f6] rounded-lg cursor-pointer transition-colors relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>{!notif.read &amp;&amp; &lt;div className="absolute left-1.5 top-1/2 -translate-y-1/2 w-1.5 h-1.5 rounded-full bg-[#dcb5b5]"&gt;&lt;/div&gt;}</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="text-xs font-bold text-[#5c5c5c] mb-0.5"&gt;{notif.title}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>&lt;div className="text-[10px] text-[#9e9e9e]"&gt;{notif.time}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>))}</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>)}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;button onClick={() =&gt; setShowProfile(true)} className="flex items-center space-x-3 group cursor-pointer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="text-right hidden md:block"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="text-xs font-bold text-[#4a4a4a] group-hover:text-[#8da399] transition-colors"&gt;{CURRENT_USER.name}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                  </span>&lt;div className="text-[10px] text-[#9e9e9e] tracking-wider"&gt;{CURRENT_USER.studentId}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="w-10 h-10 rounded-full bg-[#e0dad0] p-0.5 shadow-sm overflow-hidden group-hover:ring-2 ring-[#8da399]/50 transition-all"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;img src={CURRENT_USER.avatar} alt="User" className="bg-[#fdfcfb] rounded-full" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>{/* Logout Button moved to Header */}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;button<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>className="text-[#b0b0b0] hover:text-[#8c5e5e] transition-colors"</p>
<p class="p1"><span class="Apple-converted-space">                </span>title="登出"</p>
<p class="p1"><span class="Apple-converted-space">                </span>onClick={() =&gt; alert("您已登出系統")}</p>
<p class="p1"><span class="Apple-converted-space">              </span>&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;LogOut size={20} strokeWidth={1.5} /&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex-1 overflow-hidden px-8 pb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="h-full w-full animate-in fade-in duration-500"&gt;{renderContent()}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/main&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* Compose Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={!!composeData} onClose={() =&gt; setComposeData(null)} title={composeData?.type === 'email' ? "撰寫信件" : "傳送訊息"}&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] mb-1.5 uppercase tracking-widest"&gt;收件者&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>{composeData?.to ? (</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="flex items-center space-x-2 p-2 bg-[#f0eadd]/50 text-[#8a7a5c] rounded-lg border border-[#e0d6c1]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;User size={14}/&gt; &lt;span className="font-bold text-xs"&gt;{composeData.to}&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;button onClick={() =&gt; setComposeData({...composeData, to: null})} className="ml-auto hover:bg-[#e0d6c1] rounded-full p-1"&gt;&lt;X size={12}/&gt;&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>) : (</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div className="relative"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;select className="w-full p-2.5 border border-[#e0dad0] rounded-xl appearance-none bg-[#fdfcfb] font-medium text-xs text-[#5c5c5c] focus:outline-none focus:border-[#8da399]"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>&lt;option value=""&gt;智慧搜尋聯絡人 (輸入課程或姓名)...&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                     </span>{CONTACTS_MOCK.map(c =&gt; &lt;option key={c.id} value={c.name}&gt;{c.name} ({c.role})&lt;/option&gt;)}</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">                   </span>&lt;ChevronDown className="absolute right-3 top-3 text-[#b0b0b0] pointer-events-none" size={14}/&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>)}</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>{composeData?.type === 'email' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;div className="flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] mb-1.5 uppercase tracking-widest"&gt;主旨&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="text" defaultValue={composeData?.context ? `關於：${composeData.context}` : ''} className="p-2.5 border border-[#e0dad0] rounded-xl bg-[#fdfcfb] text-[#5c5c5c] text-xs focus:outline-none focus:border-[#8da399]" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>)}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] mb-1.5 uppercase tracking-widest"&gt;內容&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;textarea className="h-32 p-3 border border-[#e0dad0] rounded-xl bg-[#fdfcfb] text-[#5c5c5c] text-xs focus:outline-none focus:border-[#8da399] resize-none leading-relaxed" placeholder="請在此輸入您的訊息..."&gt;&lt;/textarea&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>{composeData?.type === 'email' &amp;&amp; (</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;div className="border border-dashed border-[#e0dad0] rounded-xl p-3 flex justify-center text-[#9e9e9e] cursor-pointer hover:bg-[#f7f5f0] transition-colors items-center gap-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;Paperclip size={14}/&gt; &lt;span className="text-xs"&gt;拖曳檔案至此或點擊上傳附件&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>)}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div className="flex justify-end pt-2"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;Button onClick={() =&gt; setComposeData(null)} variant="primary" icon={SendIcon} className="text-xs px-4 py-2"&gt;傳送&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">         </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>{/* User Profile Modal */}</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;Modal isOpen={showProfile} onClose={() =&gt; setShowProfile(false)} title="個人資料"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="flex flex-col items-center mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;div className="w-24 h-24 bg-[#f2f0e9] rounded-full mb-3 overflow-hidden shadow-inner p-1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">              </span>&lt;img src={CURRENT_USER.avatar} alt="User" className="w-full h-full object-cover bg-white rounded-full" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;button className="text-xs text-[#8da399] font-bold hover:underline"&gt;更換大頭貼&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="space-y-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>{[{ l: '姓名', v: CURRENT_USER.name }, { l: '系所', v: CURRENT_USER.dept }, { l: '學號', v: CURRENT_USER.studentId }, { l: '信箱', v: CURRENT_USER.email }].map((field, i) =&gt; (</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;div key={i} className="flex flex-col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;label className="text-[10px] font-bold text-[#b0b0b0] uppercase tracking-widest mb-1"&gt;{field.l}&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">               </span>&lt;input type="text" value={field.v} readOnly className="w-full p-2.5 bg-[#f7f5f0] border-none rounded-xl text-[#5c5c5c] text-sm font-medium focus:ring-0" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">             </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>))}</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div className="mt-6 flex justify-end"&gt;</p>
<p class="p1"><span class="Apple-converted-space">           </span>&lt;Button onClick={() =&gt; setShowProfile(false)} variant="primary" className="text-xs"&gt;儲存變更&lt;/Button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/Modal&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>);</p>
<p class="p1">};</p>
<p class="p2"><br></p>
<p class="p1">export default App;</p>
</body>
</html>
